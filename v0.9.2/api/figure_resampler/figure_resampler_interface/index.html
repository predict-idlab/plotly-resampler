
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the Plotly Resampler; a wrapper for plotly Figures to visualize large time-series data.">
      
      
      
        <link rel="canonical" href="https://predict-idlab.github.io/plotly-resampler/v0.9.2/api/figure_resampler/figure_resampler_interface/">
      
      
        <link rel="prev" href="../figure_resampler/">
      
      
        <link rel="next" href="../figurewidget_resampler/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.2.7">
    
    
      
        <title>figure_resampler_interface - Plotly Resampler Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#figure_resampler.figure_resampler_interface" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Plotly Resampler Documentation" class="md-header__button md-logo" aria-label="Plotly Resampler Documentation" data-md-component="logo">
      
  <img src="../../../static/icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Plotly Resampler Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              figure_resampler_interface
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/predict-idlab/plotly-resampler" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    plotly-resampler
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../getting_started/" class="md-tabs__link">
        
  
    
  
  Get started üöÄ

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../dash_app_integration/" class="md-tabs__link">
        
  
    
  
  Dash apps ü§ù

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../aggregation/" class="md-tabs__link">
          
  
  API üìñ

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../FAQ/" class="md-tabs__link">
        
  
    
  
  FAQ ‚ùì

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Plotly Resampler Documentation" class="md-nav__button md-logo" aria-label="Plotly Resampler Documentation" data-md-component="logo">
      
  <img src="../../../static/icon.png" alt="logo">

    </a>
    Plotly Resampler Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/predict-idlab/plotly-resampler" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    plotly-resampler
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get started üöÄ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../dash_app_integration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dash apps ü§ù
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API üìñ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API üìñ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../aggregation/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    aggregation
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_3_1">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            aggregation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../aggregation/aggregation_interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aggregation_interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../aggregation/aggregators/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    aggregators
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../aggregation/gap_handler_interface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gap_handler_interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../aggregation/gap_handlers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    gap_handlers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../aggregation/plotly_aggregator_parser/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plotly_aggregator_parser
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    figure_resampler
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_3_2">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            figure_resampler
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../figure_resampler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    figure_resampler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    figure_resampler_interface
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    figure_resampler_interface
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface" class="md-nav__link">
    figure_resampler_interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator" class="md-nav__link">
    AbstractFigureAggregator
  </a>
  
    <nav class="md-nav" aria-label="AbstractFigureAggregator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.hf_data" class="md-nav__link">
    hf_data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.__reduce__" class="md-nav__link">
    __reduce__()
  </a>
  
    <nav class="md-nav" aria-label="__reduce__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.__reduce__--note" class="md-nav__link">
    Note
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace" class="md-nav__link">
    add_trace()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_traces" class="md-nav__link">
    add_traces()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.construct_update_data_patch" class="md-nav__link">
    construct_update_data_patch()
  </a>
  
    <nav class="md-nav" aria-label="construct_update_data_patch()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.construct_update_data_patch--attention" class="md-nav__link">
    Attention
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.replace" class="md-nav__link">
    replace()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../figurewidget_resampler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    figurewidget_resampler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../jupyter_dash_persistent_inline_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    jupyter_dash_persistent_inline_output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../registering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    registering
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../../../FAQ/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ ‚ùì
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface" class="md-nav__link">
    figure_resampler_interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator" class="md-nav__link">
    AbstractFigureAggregator
  </a>
  
    <nav class="md-nav" aria-label="AbstractFigureAggregator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.hf_data" class="md-nav__link">
    hf_data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.__reduce__" class="md-nav__link">
    __reduce__()
  </a>
  
    <nav class="md-nav" aria-label="__reduce__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.__reduce__--note" class="md-nav__link">
    Note
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace" class="md-nav__link">
    add_trace()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_traces" class="md-nav__link">
    add_traces()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.construct_update_data_patch" class="md-nav__link">
    construct_update_data_patch()
  </a>
  
    <nav class="md-nav" aria-label="construct_update_data_patch()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.construct_update_data_patch--attention" class="md-nav__link">
    Attention
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.replace" class="md-nav__link">
    replace()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>figure_resampler_interface</h1>

<div class="doc doc-object doc-module">



<a id="figure_resampler.figure_resampler_interface"></a>
  <div class="doc doc-contents first">
  
      <p>Abstract <code>AbstractFigureAggregator</code> interface for the concrete <em>Resampler</em> classes.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">




<h2 id="figure_resampler.figure_resampler_interface.AbstractFigureAggregator" class="doc doc-heading">
          <code>AbstractFigureAggregator</code>


<a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="plotly.basedatatypes.BaseFigure">BaseFigure</span></code>, <code><span title="abc.ABC">ABC</span></code></p>

  
      <p>Abstract interface for data aggregation functionality for plotly figures.</p>

            <details class="quote">
              <summary>Source code in <code>plotly_resampler/figure_resampler/figure_resampler_interface.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AbstractFigureAggregator</span><span class="p">(</span><span class="n">BaseFigure</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract interface for data aggregation functionality for plotly figures.&quot;&quot;&quot;</span>

    <span class="n">_high_frequency_traces</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;scatter&quot;</span><span class="p">,</span> <span class="s2">&quot;scattergl&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">figure</span><span class="p">:</span> <span class="n">BaseFigure</span><span class="p">,</span>
        <span class="n">convert_existing_traces</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">default_n_shown_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="n">default_downsampler</span><span class="p">:</span> <span class="n">AbstractAggregator</span> <span class="o">=</span> <span class="n">MinMaxLTTB</span><span class="p">(),</span>
        <span class="n">default_gap_handler</span><span class="p">:</span> <span class="n">AbstractGapHandler</span> <span class="o">=</span> <span class="n">MedDiffGapHandler</span><span class="p">(),</span>
        <span class="n">resampled_trace_prefix_suffix</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;&lt;b style=&quot;color:sandybrown&quot;&gt;[R]&lt;/b&gt; &#39;</span><span class="p">,</span>
            <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">show_mean_aggregation_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">convert_traces_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Instantiate a resampling data mirror.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        figure: BaseFigure</span>
<span class="sd">            The figure that will be decorated. Can be either an empty figure</span>
<span class="sd">            (e.g., ``go.Figure()``, ``make_subplots()``, ``go.FigureWidget``) or an</span>
<span class="sd">            existing figure.</span>
<span class="sd">        convert_existing_traces: bool</span>
<span class="sd">            A bool indicating whether the high-frequency traces of the passed ``figure``</span>
<span class="sd">            should be resampled, by default True. Hence, when set to False, the</span>
<span class="sd">            high-frequency traces of the passed ``figure`` will not be resampled.</span>
<span class="sd">        default_n_shown_samples: int, optional</span>
<span class="sd">            The default number of samples that will be shown for each trace,</span>
<span class="sd">            by default 1000.\n</span>
<span class="sd">            !!! note</span>
<span class="sd">                * This can be overridden within the [`add_trace`][figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace] method.</span>
<span class="sd">                * If a trace withholds fewer datapoints than this parameter,</span>
<span class="sd">                  the data will *not* be aggregated.</span>
<span class="sd">        default_downsampler: AbstractAggregator</span>
<span class="sd">            An instance which implements the AbstractSeriesDownsampler interface and</span>
<span class="sd">            will be used as default downsampler, by default ``MinMaxLTTB``. \n</span>
<span class="sd">            !!! note</span>
<span class="sd">                This can be overridden within the [`add_trace`][figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace] method.</span>
<span class="sd">        default_gap_handler: GapHandler</span>
<span class="sd">            An instance which implements the AbstractGapHandler interface and will be</span>
<span class="sd">            used as default gap handler, by default ``MedDiffGapHandler``. \n</span>
<span class="sd">            !!! note</span>
<span class="sd">                This can be overridden within the [`add_trace`][figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace] method.</span>
<span class="sd">        resampled_trace_prefix_suffix: str, optional</span>
<span class="sd">            A tuple which contains the ``prefix`` and ``suffix``, respectively, which</span>
<span class="sd">            will be added to the trace its legend-name when a resampled version of the</span>
<span class="sd">            trace is shown. By default, a bold, orange ``[R]`` is shown as prefix</span>
<span class="sd">            (no suffix is shown).</span>
<span class="sd">        show_mean_aggregation_size: bool, optional</span>
<span class="sd">            Whether the mean aggregation bin size will be added as a suffix to the trace</span>
<span class="sd">            its legend-name, by default True.</span>
<span class="sd">        convert_traces_kwargs: dict, optional</span>
<span class="sd">            A dict of kwargs that will be passed to the [`add_traces`][figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_traces] method and</span>
<span class="sd">            will be used to convert the existing traces. \n</span>
<span class="sd">            !!! note</span>
<span class="sd">                This argument is only used when the passed ``figure`` contains data and</span>
<span class="sd">                ``convert_existing_traces`` is set to True.</span>
<span class="sd">        verbose: bool, optional</span>
<span class="sd">            Whether some verbose messages will be printed or not, by default False.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hf_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_n_shown_samples</span> <span class="o">=</span> <span class="n">default_n_shown_samples</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_print_verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_mean_aggregation_size</span> <span class="o">=</span> <span class="n">show_mean_aggregation_size</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">resampled_trace_prefix_suffix</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suffix</span> <span class="o">=</span> <span class="n">resampled_trace_prefix_suffix</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_global_downsampler</span> <span class="o">=</span> <span class="n">default_downsampler</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_gap_handler</span> <span class="o">=</span> <span class="n">default_gap_handler</span>

        <span class="c1"># Given figure should always be a BaseFigure that is not wrapped by</span>
        <span class="c1"># a plotly-resampler class</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">BaseFigure</span><span class="p">)</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">figure</span><span class="p">),</span> <span class="n">AbstractFigureAggregator</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figure_class</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="vm">__class__</span>

        <span class="c1"># Overwrite the passed arguments with the property dict values</span>
        <span class="c1"># (this is the case when the PR figure is created from a pickled object)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="s2">&quot;_pr_props&quot;</span><span class="p">):</span>
            <span class="n">pr_props</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">_pr_props</span>  <span class="c1"># a dict of PR properties</span>
            <span class="k">if</span> <span class="n">pr_props</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Overwrite the default arguments with the serialized properties</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pr_props</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="s2">&quot;_pr_props&quot;</span><span class="p">)</span>  <span class="c1"># should not be stored anymore</span>

        <span class="k">if</span> <span class="n">convert_existing_traces</span><span class="p">:</span>
            <span class="c1"># call __init__ with the correct layout and set the `_grid_ref` of the</span>
            <span class="c1"># to-be-converted figure</span>
            <span class="n">f_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figure_class</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">figure</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>
            <span class="n">f_</span><span class="o">.</span><span class="n">_grid_str</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">_grid_str</span>
            <span class="n">f_</span><span class="o">.</span><span class="n">_grid_ref</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">_grid_ref</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">f_</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">convert_traces_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">convert_traces_kwargs</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="c1"># make sure that the UIDs of these traces do not get adjusted</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_validator</span><span class="o">.</span><span class="n">set_uid</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_traces</span><span class="p">(</span><span class="n">figure</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">convert_traces_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_validator</span><span class="o">.</span><span class="n">set_uid</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># A list of al xaxis and yaxis string names</span>
        <span class="c1"># e.g., &quot;xaxis&quot;, &quot;xaxis2&quot;, &quot;xaxis3&quot;, .... for _xaxis_list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xaxis_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_re_matches</span><span class="p">(</span>
            <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;xaxis\d*&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layout</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_yaxis_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_re_matches</span><span class="p">(</span>
            <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;yaxis\d*&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layout</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="c1"># edge case: an empty `go.Figure()` does not yet contain axes keys</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xaxis_list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_xaxis_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;xaxis&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_yaxis_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;yaxis&quot;</span><span class="p">]</span>

        <span class="c1"># Make sure to reset the layout its range</span>
        <span class="c1"># self.update_layout(</span>
        <span class="c1">#     {</span>
        <span class="c1">#         axis: {&quot;autorange&quot;: None, &quot;range&quot;: None}</span>
        <span class="c1">#         for axis in self._xaxis_list + self._yaxis_list</span>
        <span class="c1">#     }</span>
        <span class="c1"># )</span>

    <span class="k">def</span> <span class="nf">_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper method for printing if ``verbose`` is set to True.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_print_verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_query_hf_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trace</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Query the internal ``_hf_data`` attribute and returns a match based on</span>
<span class="sd">        ``uid``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        trace : dict</span>
<span class="sd">            The trace where we want to find a match for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Optional[dict]</span>
<span class="sd">            The ``hf_data``-trace dict if a match is found, else ``None``.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">uid</span> <span class="o">=</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;uid&quot;</span><span class="p">]</span>
        <span class="n">hf_trace_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hf_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">uid</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">hf_trace_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">trace_props</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">trace</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">difference</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">})</span>
            <span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[W] trace with </span><span class="si">{</span><span class="n">trace_props</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">hf_trace_data</span>

    <span class="k">def</span> <span class="nf">_get_current_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create an efficient copy of the current graph by omitting the &quot;hovertext&quot;,</span>
<span class="sd">        &quot;x&quot;, and &quot;y&quot; properties of each trace.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            The current graph dict</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        https://github.com/plotly/plotly.py/blob/2e7f322c5ea4096ce6efe3b4b9a34d9647a8be9c/packages/python/plotly/plotly/basedatatypes.py#L3278</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="n">k</span><span class="p">:</span> <span class="n">copy</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="c1"># TODO: why not &quot;text&quot; as well? -&gt; we can use _hf_data_container.fields then</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">difference</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;hovertext&quot;</span><span class="p">})</span>
                <span class="p">}</span>
                <span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
            <span class="p">],</span>
            <span class="s2">&quot;layout&quot;</span><span class="p">:</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_layout</span><span class="p">),</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_parse_trace_name</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">hf_trace_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">slice_len</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">agg_x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse the trace name.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hf_trace_data : dict</span>
<span class="sd">            The high-frequency trace data dict.</span>
<span class="sd">        slice_len : int</span>
<span class="sd">            The length of the slice.</span>
<span class="sd">        agg_x : np.ndarray</span>
<span class="sd">            The x-axis values of the aggregated trace.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">            The parsed trace name.</span>
<span class="sd">            When no downsampling is needed, the original trace name is returned.</span>
<span class="sd">            When downsampling is needed, the average bin size (expressed in x-units) is</span>
<span class="sd">            added in orange color with a `~` to the trace name.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">slice_len</span> <span class="o">&lt;=</span> <span class="n">hf_trace_data</span><span class="p">[</span><span class="s2">&quot;max_n_samples&quot;</span><span class="p">]:</span>  <span class="c1"># When no downsampling needed</span>
            <span class="k">return</span> <span class="n">hf_trace_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>

        <span class="c1"># The data is downsampled, so we add the downsampling information to the name</span>
        <span class="n">agg_prefix</span><span class="p">,</span> <span class="n">agg_suffix</span> <span class="o">=</span> <span class="s1">&#39; &lt;i style=&quot;color:#fc9944&quot;&gt;~&#39;</span><span class="p">,</span> <span class="s2">&quot;&lt;/i&gt;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span> <span class="o">+</span> <span class="n">hf_trace_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suffix</span>

        <span class="c1"># Add the mean aggregation bin size to the trace name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show_mean_aggregation_size</span><span class="p">:</span>
            <span class="c1"># Base case ...</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">agg_x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">name</span>

            <span class="n">mean_bin_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">agg_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">agg_x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">agg_x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># mean bin size</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mean_bin_size</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">)):</span>
                <span class="n">mean_bin_size</span> <span class="o">=</span> <span class="n">round_td_str</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="n">mean_bin_size</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mean_bin_size</span> <span class="o">=</span> <span class="n">round_number_str</span><span class="p">(</span><span class="n">mean_bin_size</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">agg_prefix</span><span class="si">}{</span><span class="n">mean_bin_size</span><span class="si">}{</span><span class="n">agg_suffix</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">_check_update_trace_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">trace</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">end</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">BaseTraceType</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check and update the passed ``trace`` its data properties based on the</span>
<span class="sd">        slice range.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        This is a pass by reference. The passed trace object will be updated and</span>
<span class="sd">        returned if found in ``hf_data``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        trace : BaseTraceType or dict</span>
<span class="sd">             - An instances of a trace class from the ``plotly.graph_objects`` (go)</span>
<span class="sd">                package (e.g, ``go.Scatter``, ``go.Bar``)</span>
<span class="sd">             - or a dict where:</span>

<span class="sd">                  - The &#39;type&#39; property specifies the trace type (e.g.</span>
<span class="sd">                    &#39;scatter&#39;, &#39;bar&#39;, &#39;area&#39;, etc.). If the dict has no &#39;type&#39;</span>
<span class="sd">                    property then &#39;scatter&#39; is assumed.</span>
<span class="sd">                  - All remaining properties are passed to the constructor</span>
<span class="sd">                    of the specified trace type.</span>

<span class="sd">        start : Union[float, str], optional</span>
<span class="sd">            The start index for which we want resampled data to be updated to,</span>
<span class="sd">            by default None,</span>
<span class="sd">        end : Union[float, str], optional</span>
<span class="sd">            The end index for which we want the resampled data to be updated to,</span>
<span class="sd">            by default None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Optional[Union[dict, BaseTraceType]]</span>
<span class="sd">            If the matching ``hf_series`` is found in ``hf_dict``, an (updated) trace</span>
<span class="sd">            will be returned, otherwise None.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        * If ``start`` and ``stop`` are strings, they most likely represent time-strings</span>
<span class="sd">        * ``start`` and ``stop`` will always be of the same type (float / time-string)</span>
<span class="sd">           because their underlying axis is the same.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hf_trace_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_query_hf_data</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hf_trace_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="s2">&quot;hf_data not found&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="c1"># Parse trace data (necessary when updating the trace data)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">_hf_data_container</span><span class="o">.</span><span class="n">_fields</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span>
                <span class="n">hf_trace_data</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="c1"># is faster to escape the loop here than check inside the hasattr if</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeTZDtype</span><span class="o">.</span><span class="n">is_dtype</span><span class="p">(</span><span class="n">hf_trace_data</span><span class="p">[</span><span class="n">k</span><span class="p">]):</span>
                <span class="c1"># When we use the .values method, timezone information is lost</span>
                <span class="c1"># so convert it to pd.DatetimeIndex, which preserves the tz-info</span>
                <span class="n">hf_trace_data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">hf_trace_data</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">hf_trace_data</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="s2">&quot;values&quot;</span><span class="p">):</span>
                <span class="c1"># when not a range index or datetime index</span>
                <span class="n">hf_trace_data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">hf_trace_data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

        <span class="c1"># Also check if the y-data is empty, if so, return an empty trace</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hf_trace_data</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hf_trace_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">trace</span>

        <span class="c1"># Leverage the axis type to get the start and end indices</span>
        <span class="c1"># Note: the axis type specified in the figure layout takes precedence over the</span>
        <span class="c1"># the axis type which is inferred from the data (and stored in hf_trace_data)</span>
        <span class="c1"># TODO: verify if we need to use `axis`of anchor as key to determing axis type</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;xaxis&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">axis_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">_props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">axis</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;axis&quot;</span> <span class="o">+</span> <span class="n">axis</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="n">hf_trace_data</span><span class="p">[</span><span class="s2">&quot;axis_type&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span> <span class="o">=</span> <span class="n">PlotlyAggregatorParser</span><span class="o">.</span><span class="n">get_start_end_indices</span><span class="p">(</span>
            <span class="n">hf_trace_data</span><span class="p">,</span> <span class="n">axis_type</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span>
        <span class="p">)</span>

        <span class="c1"># Return an invisible, single-point, trace when the sliced hf_series doesn&#39;t</span>
        <span class="c1"># contain any data in the current view</span>
        <span class="k">if</span> <span class="n">end_idx</span> <span class="o">==</span> <span class="n">start_idx</span><span class="p">:</span>
            <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">hf_trace_data</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
            <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hf_trace_data</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">trace</span>

        <span class="n">agg_x</span><span class="p">,</span> <span class="n">agg_y</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">PlotlyAggregatorParser</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
            <span class="n">hf_trace_data</span><span class="p">,</span> <span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span>
        <span class="p">)</span>

        <span class="c1"># -------------------- Set the hf_trace_data_props -------------------</span>
        <span class="c1"># Parse the data types to an orjson compatible format</span>
        <span class="c1"># NOTE: this can be removed once orjson supports f16</span>
        <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_dtype_orjson</span><span class="p">(</span><span class="n">agg_x</span><span class="p">)</span>
        <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_dtype_orjson</span><span class="p">(</span><span class="n">agg_y</span><span class="p">)</span>
        <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_trace_name</span><span class="p">(</span>
            <span class="n">hf_trace_data</span><span class="p">,</span> <span class="n">end_idx</span> <span class="o">-</span> <span class="n">start_idx</span><span class="p">,</span> <span class="n">agg_x</span>
        <span class="p">)</span>

        <span class="k">def</span> <span class="nf">_nest_dict_rec</span><span class="p">(</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="nb">any</span><span class="p">,</span> <span class="n">out</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Recursively nest a dict based on the key whose &#39;_&#39; indicates level.&quot;&quot;&quot;</span>
            <span class="n">k</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rest</span><span class="p">:</span>
                <span class="n">_nest_dict_rec</span><span class="p">(</span><span class="n">rest</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">{}))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="c1"># Check if (hover)text also needs to be downsampled</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;hovertext&quot;</span><span class="p">,</span> <span class="s2">&quot;marker_size&quot;</span><span class="p">,</span> <span class="s2">&quot;marker_color&quot;</span><span class="p">,</span> <span class="s2">&quot;customdata&quot;</span><span class="p">]:</span>
            <span class="n">k_val</span> <span class="o">=</span> <span class="n">hf_trace_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k_val</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span>
                    <span class="n">hf_trace_data</span><span class="p">[</span><span class="s2">&quot;downsampler&quot;</span><span class="p">],</span> <span class="n">DataPointSelector</span>
                <span class="p">),</span> <span class="s2">&quot;Only DataPointSelector can downsample non-data trace array props.&quot;</span>
                <span class="n">_nest_dict_rec</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k_val</span><span class="p">[</span><span class="n">start_idx</span> <span class="o">+</span> <span class="n">indices</span><span class="p">],</span> <span class="n">trace</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">k_val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">trace</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">k_val</span>

        <span class="k">return</span> <span class="n">trace</span>

    <span class="k">def</span> <span class="nf">_layout_xaxis_to_trace_xaxis_mapping</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a dict which maps the layout xaxis keys to the trace xaxis keys.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Dict[str, List[str]]</span>
<span class="sd">            A dict with the layout xaxis values as keys and the trace its corresponding</span>
<span class="sd">            xaxis anchor value.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># edge case: an empty `go.Figure()` does not yet contain axes keys</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_grid_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;xaxis&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]}</span>

        <span class="n">mapping_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">sub_plot</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_grid_ref</span><span class="p">):</span>  <span class="c1"># flattten</span>
            <span class="n">sub_plot</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">sub_plot</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">sub_plot</span>
            <span class="k">for</span> <span class="n">axes</span> <span class="ow">in</span> <span class="n">sub_plot</span><span class="p">:</span>  <span class="c1"># NOTE: you can have multiple axes in a subplot</span>
                <span class="n">layout_xaxes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">layout_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">trace_xaxes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">trace_kwargs</span><span class="p">[</span><span class="s2">&quot;xaxis&quot;</span><span class="p">]</span>

                <span class="c1"># append the trace xaxis to the layout xaxis key its value list</span>
                <span class="n">mapping_dict</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">layout_xaxes</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace_xaxes</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mapping_dict</span>

    <span class="k">def</span> <span class="nf">_check_update_figure_dict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">figure</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stop</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">layout_xaxis_filter</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">updated_trace_indices</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check and update the traces within the figure dict.</span>

<span class="sd">        hint</span>
<span class="sd">        ----</span>
<span class="sd">        This method will most likely be used within a ``Dash`` callback to resample the</span>
<span class="sd">        view, based on the configured number of parameters.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        This is a pass by reference. The passed figure object will be updated.</span>
<span class="sd">        No new view of this figure will be created, hence no return!</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        figure : dict</span>
<span class="sd">            The figure dict which will be updated.</span>
<span class="sd">        start : Union[float, str], optional</span>
<span class="sd">            The start time for the new resampled data view, by default None.</span>
<span class="sd">        stop : Union[float, str], optional</span>
<span class="sd">            The end time for the new resampled data view, by default None.</span>
<span class="sd">        layout_xaxis_filter: str, optional</span>
<span class="sd">            Additional layout xaxis filter, e.g. the affected x-axis values by the</span>
<span class="sd">            triggered relayout event (e.g. xaxis), by default None.</span>
<span class="sd">        updated_trace_indices: List[int], optional</span>
<span class="sd">            List of trace indices that already have been updated, by default None.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List[int]</span>
<span class="sd">            A list of indices withholding the trace-data-array-index from the of data</span>
<span class="sd">            modalities which are updated.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">updated_trace_indices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">updated_trace_indices</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">layout_xaxis_filter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">layout_trace_mapping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layout_xaxis_to_trace_xaxis_mapping</span><span class="p">()</span>
            <span class="c1"># Retrieve the trace xaxis values that are affected by the relayout event</span>
            <span class="n">trace_xaxis_filter</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">layout_trace_mapping</span><span class="p">[</span><span class="n">layout_xaxis_filter</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">trace</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">figure</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">]):</span>
            <span class="c1"># We skip when (i) the trace-idx already has been updated or (ii) when</span>
            <span class="c1"># there is a layout_xaxis_filter and the trace xaxis is not in the filter</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">updated_trace_indices</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="n">layout_xaxis_filter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">trace</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;xaxis&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">trace_xaxis_filter</span>
            <span class="p">):</span>
                <span class="k">continue</span>

            <span class="c1"># If we managed to find and update the trace, it will return the trace</span>
            <span class="c1"># and thus not None.</span>
            <span class="n">updated_trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_update_trace_data</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">stop</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">updated_trace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">updated_trace_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">updated_trace_indices</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_figure_class</span><span class="p">(</span><span class="n">constr</span><span class="p">:</span> <span class="nb">type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">type</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the plotly figure class (constructor) for the given class (constructor).</span>

<span class="sd">        !!! note</span>
<span class="sd">            This method will always return a plotly constructor, even when the given</span>
<span class="sd">            `constr` is decorated (after executing the ``register_plotly_resampler``</span>
<span class="sd">            function).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        constr: type</span>
<span class="sd">            The constructor class for which we want to retrieve the plotly constructor.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type:</span>
<span class="sd">            The plotly figure class (constructor) of the given `constr`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">..registering</span> <span class="kn">import</span> <span class="n">_get_plotly_constr</span>  <span class="c1"># To avoid ImportError</span>

        <span class="k">return</span> <span class="n">_get_plotly_constr</span><span class="p">(</span><span class="n">constr</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">hf_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Property to adjust the `data` component of the current graph</span>

<span class="sd">        !!! note</span>
<span class="sd">            The user has full responsibility to adjust ``hf_data`` properly.</span>


<span class="sd">        ??? example</span>

<span class="sd">            ```python</span>
<span class="sd">                &gt;&gt;&gt; from plotly_resampler import FigureResampler</span>
<span class="sd">                &gt;&gt;&gt; fig = FigureResampler(go.Figure())</span>
<span class="sd">                &gt;&gt;&gt; fig.add_trace(...)</span>
<span class="sd">                &gt;&gt;&gt; # Adjust the y property of the above added trace</span>
<span class="sd">                &gt;&gt;&gt; fig.hf_data[-1][&quot;y&quot;] = - s ** 2</span>
<span class="sd">                &gt;&gt;&gt; fig.hf_data</span>
<span class="sd">                [</span>
<span class="sd">                    {</span>
<span class="sd">                        &#39;max_n_samples&#39;: 1000,</span>
<span class="sd">                        &#39;x&#39;: RangeIndex(start=0, stop=11000000, step=1),</span>
<span class="sd">                        &#39;y&#39;: array([-0.01339909,  0.01390696,, ...,  0.25051913, 0.55876513]),</span>
<span class="sd">                        &#39;axis_type&#39;: &#39;linear&#39;,</span>
<span class="sd">                        &#39;downsampler&#39;: &lt;plotly_resampler.aggregation.aggregators.LTTB at 0x7f786d5a9ca0&gt;,</span>
<span class="sd">                        &#39;text&#39;: None,</span>
<span class="sd">                        &#39;hovertext&#39;: None</span>
<span class="sd">                    },</span>
<span class="sd">                ]</span>
<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hf_data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_parse_get_trace_props</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">trace</span><span class="p">:</span> <span class="n">BaseTraceType</span><span class="p">,</span>
        <span class="n">hf_x</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hf_y</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hf_text</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hf_hovertext</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hf_marker_size</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hf_marker_color</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">check_nans</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_hf_data_container</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse and capture the possibly high-frequency trace-props in a datacontainer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        trace : BaseTraceType</span>
<span class="sd">            The trace which will be parsed.</span>
<span class="sd">        hf_x : Iterable, optional</span>
<span class="sd">            High-frequency trace &quot;x&quot; data, overrides the current trace its x-data.</span>
<span class="sd">        hf_y : Iterable, optional</span>
<span class="sd">            High-frequency trace &quot;y&quot; data, overrides the current trace its y-data.</span>
<span class="sd">        hf_text : Iterable, optional</span>
<span class="sd">            High-frequency trace &quot;text&quot; data, overrides the current trace its text-data.</span>
<span class="sd">        hf_hovertext : Iterable, optional</span>
<span class="sd">            High-frequency trace &quot;hovertext&quot; data, overrides the current trace its</span>
<span class="sd">            hovertext data.</span>
<span class="sd">        check_nans: bool, optional</span>
<span class="sd">            Whether the `hf_y` should be checked for NaNs, by default True.</span>
<span class="sd">            As checking for NaNs is expensive, this can be disabled when the `hf_y` is</span>
<span class="sd">            already known to contain no NaNs (or when the downsampler can handle NaNs,</span>
<span class="sd">            e.g., EveryNthPoint).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        _hf_data_container</span>
<span class="sd">            A namedtuple which serves as a datacontainer.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hf_x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="p">(</span>
            <span class="c1"># fmt: off</span>
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">trace</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">hf_x</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="c1"># If we cast a tz-aware datetime64 array to `.values` we lose the tz-info </span>
            <span class="c1"># and the UTC time will be displayed instead of the tz-localized time, </span>
            <span class="c1"># hence we cast to a pd.DatetimeIndex, which preserves the tz-info</span>
            <span class="c1"># As a matter of fact, to resolve #231, we also convert non-tz-aware </span>
            <span class="c1"># datetime64 arrays to an pd.Index</span>
            <span class="k">else</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">hf_x</span><span class="p">)</span> <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">is_datetime64_any_dtype</span><span class="p">(</span><span class="n">hf_x</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">hf_x</span><span class="o">.</span><span class="n">values</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hf_x</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">hf_x</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hf_x</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">hf_x</span><span class="p">)</span>
            <span class="c1"># fmt: on</span>
        <span class="p">)</span>

        <span class="n">hf_y</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">hf_y</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">hf_y</span><span class="o">.</span><span class="n">values</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hf_y</span><span class="p">,</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">))</span>
            <span class="k">else</span> <span class="n">hf_y</span>
        <span class="p">)</span>
        <span class="c1"># NOTE: the if will not be triggered for a categorical series its values</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">hf_y</span><span class="p">,</span> <span class="s2">&quot;dtype&quot;</span><span class="p">):</span>
            <span class="n">hf_y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">hf_y</span><span class="p">)</span>

        <span class="n">hf_text</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">hf_text</span>
            <span class="k">if</span> <span class="n">hf_text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

        <span class="n">hf_hovertext</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">hf_hovertext</span>
            <span class="k">if</span> <span class="n">hf_hovertext</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;hovertext&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="s2">&quot;hovertext&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;hovertext&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

        <span class="n">hf_marker_size</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">hf_marker_size</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="s2">&quot;marker&quot;</span><span class="p">)</span>
                <span class="ow">and</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">else</span> <span class="n">hf_marker_size</span>
        <span class="p">)</span>

        <span class="n">hf_marker_color</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">hf_marker_color</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="s2">&quot;marker&quot;</span><span class="p">)</span>
                <span class="ow">and</span> <span class="s2">&quot;color&quot;</span> <span class="ow">in</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">else</span> <span class="n">hf_marker_color</span>
        <span class="p">)</span>

        <span class="n">hf_customdata</span> <span class="o">=</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;customdata&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="s2">&quot;customdata&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_high_frequency_traces</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hf_x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># if no data as x or hf_x is passed</span>
                <span class="k">if</span> <span class="n">hf_y</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># if hf_y is an array</span>
                    <span class="n">hf_x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">RangeIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hf_y</span><span class="p">))</span>  <span class="c1"># np.arange(len(hf_y))</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># if no data as y or hf_y is passed</span>
                    <span class="n">hf_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

            <span class="k">assert</span> <span class="n">hf_y</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">hf_x</span><span class="p">),</span> <span class="p">(</span>
                <span class="s2">&quot;plotly-resampler requires scatter data &quot;</span>
                <span class="s2">&quot;(i.e., x and y, or hf_x and hf_y) to have the same dimensionality!&quot;</span>
            <span class="p">)</span>
            <span class="c1"># When the x or y of a trace has more than 1 dimension, it is not at all</span>
            <span class="c1"># straightforward how it should be resampled.</span>
            <span class="k">assert</span> <span class="n">hf_y</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">hf_x</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span>
                <span class="s2">&quot;plotly-resampler requires scatter data &quot;</span>
                <span class="s2">&quot;(i.e., x and y, or hf_x and hf_y) to be &lt;= 1 dimensional!&quot;</span>
            <span class="p">)</span>

            <span class="c1"># Note: this converts the hf property to a np.ndarray</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hf_text</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
                <span class="n">hf_text</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">hf_text</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hf_hovertext</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
                <span class="n">hf_hovertext</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">hf_hovertext</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hf_marker_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
                <span class="n">hf_marker_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">hf_marker_size</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hf_marker_color</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)):</span>
                <span class="n">hf_marker_color</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">hf_marker_color</span><span class="p">)</span>

            <span class="c1"># Remove NaNs for efficiency (storing less meaningless data)</span>
            <span class="c1"># NaNs introduce gaps between enclosing non-NaN data points &amp; might distort</span>
            <span class="c1"># the resampling algorithms</span>
            <span class="k">if</span> <span class="n">check_nans</span> <span class="ow">and</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">hf_y</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">not_nan_mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">hf_y</span><span class="p">)</span>
                <span class="n">hf_x</span> <span class="o">=</span> <span class="n">hf_x</span><span class="p">[</span><span class="n">not_nan_mask</span><span class="p">]</span>
                <span class="n">hf_y</span> <span class="o">=</span> <span class="n">hf_y</span><span class="p">[</span><span class="n">not_nan_mask</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hf_text</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="n">hf_text</span> <span class="o">=</span> <span class="n">hf_text</span><span class="p">[</span><span class="n">not_nan_mask</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hf_hovertext</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="n">hf_hovertext</span> <span class="o">=</span> <span class="n">hf_hovertext</span><span class="p">[</span><span class="n">not_nan_mask</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hf_marker_size</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="n">hf_marker_size</span> <span class="o">=</span> <span class="n">hf_marker_size</span><span class="p">[</span><span class="n">not_nan_mask</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hf_marker_color</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="n">hf_marker_color</span> <span class="o">=</span> <span class="n">hf_marker_color</span><span class="p">[</span><span class="n">not_nan_mask</span><span class="p">]</span>

            <span class="c1"># Try to parse the hf_x data if it is of object type or</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">hf_x</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">hf_x</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span> <span class="ow">or</span> <span class="n">hf_x</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Try to parse to numeric</span>
                    <span class="n">hf_x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">hf_x</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="c1"># Try to parse to datetime</span>
                        <span class="n">hf_x</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">hf_x</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">)</span>
                        <span class="c1"># Will be cast to object array if it contains multiple timezones.</span>
                        <span class="k">if</span> <span class="n">hf_x</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                <span class="s2">&quot;The x-data contains multiple timezones, which is not &quot;</span>
                                <span class="s2">&quot;supported by plotly-resampler!&quot;</span>
                            <span class="p">)</span>
                    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">&quot;plotly-resampler requires the x-data to be numeric or &quot;</span>
                            <span class="s2">&quot;datetime-like </span><span class="se">\n</span><span class="s2">More details in the stacktrace above.&quot;</span>
                        <span class="p">)</span>

            <span class="c1"># If the categorical or string-like hf_y data is of type object (happens</span>
            <span class="c1"># when y argument is used for the trace constructor instead of hf_y), we</span>
            <span class="c1"># transform it to type string as such it will be sent as categorical data</span>
            <span class="c1"># to the downsampling algorithm</span>
            <span class="k">if</span> <span class="n">hf_y</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s2">&quot;object&quot;</span> <span class="ow">or</span> <span class="n">hf_y</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">str_</span><span class="p">:</span>
                <span class="c1"># But first, we try to parse to a numeric dtype (as this is the</span>
                <span class="c1"># behavior that plotly supports)</span>
                <span class="c1"># Note that a bool array of type object will remain a bool array (and</span>
                <span class="c1"># not will be transformed to an array of ints (0, 1))</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">hf_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">hf_y</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">hf_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Categorical</span><span class="p">(</span><span class="n">hf_y</span><span class="p">)</span>  <span class="c1"># TODO: ordered=True?</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">hf_x</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">hf_y</span><span class="p">),</span> <span class="s2">&quot;x and y have different length!&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;trace </span><span class="si">{</span><span class="n">trace</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> is not a high-frequency trace&quot;</span><span class="p">)</span>

            <span class="c1"># hf_x and hf_y have priority over the traces&#39; data</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">):</span>
                <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hf_x</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">):</span>
                <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hf_y</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">):</span>
                <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hf_text</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="s2">&quot;hovertext&quot;</span><span class="p">):</span>
                <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;hovertext&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hf_hovertext</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="s2">&quot;marker&quot;</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">marker</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">):</span>
                    <span class="n">trace</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">hf_marker_size</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">marker</span><span class="p">,</span> <span class="s2">&quot;color&quot;</span><span class="p">):</span>
                    <span class="n">trace</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">hf_marker_color</span>

        <span class="k">return</span> <span class="n">_hf_data_container</span><span class="p">(</span>
            <span class="n">hf_x</span><span class="p">,</span>
            <span class="n">hf_y</span><span class="p">,</span>
            <span class="n">hf_text</span><span class="p">,</span>
            <span class="n">hf_hovertext</span><span class="p">,</span>
            <span class="n">hf_marker_size</span><span class="p">,</span>
            <span class="n">hf_marker_color</span><span class="p">,</span>
            <span class="n">hf_customdata</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_construct_hf_data_dict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dc</span><span class="p">:</span> <span class="n">_hf_data_container</span><span class="p">,</span>
        <span class="n">trace</span><span class="p">:</span> <span class="n">BaseTraceType</span><span class="p">,</span>
        <span class="n">downsampler</span><span class="p">:</span> <span class="n">AbstractAggregator</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">gap_handler</span><span class="p">:</span> <span class="n">AbstractGapHandler</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">max_n_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create the `hf_data` dict which will be put in the `_hf_data` property.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dc : _hf_data_container</span>
<span class="sd">            The hf_data container, withholding the parsed hf-data.</span>
<span class="sd">        trace : BaseTraceType</span>
<span class="sd">            The trace.</span>
<span class="sd">        downsampler : AbstractAggregator | None</span>
<span class="sd">            The downsampler which will be used.</span>
<span class="sd">        gap_handler : AbstractGapHandler | None</span>
<span class="sd">            The gap handler which will be used.</span>
<span class="sd">        max_n_samples : int | None</span>
<span class="sd">            The max number of output samples.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            The hf_data dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Checking this now avoids less interpretable `KeyError` when resampling</span>
        <span class="n">assert_text</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;In order to perform time series aggregation, the data must be &quot;</span>
            <span class="s2">&quot;sorted in time; i.e., the x-data must be (non-strictly) &quot;</span>
            <span class="s2">&quot;monotonically increasing.&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">dc</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">is_monotonic_increasing</span><span class="p">,</span> <span class="n">assert_text</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">is_monotonic_increasing</span><span class="p">,</span> <span class="n">assert_text</span>

        <span class="c1"># As we support prefix-suffixing of downsampled data, we assure that</span>
        <span class="c1"># each trace has a name</span>
        <span class="c1"># https://github.com/plotly/plotly.py/blob/ce0ed07d872c487698bde9d52e1f1aadf17aa65f/packages/python/plotly/plotly/basedatatypes.py#L539</span>
        <span class="c1"># The link above indicates that the trace index is derived from `data`</span>
        <span class="k">if</span> <span class="n">trace</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">trace</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;trace </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">offset</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Determine (1) the axis type and (2) the downsampler instance</span>
        <span class="c1"># &amp; (3) store a hf_data entry for the corresponding trace,</span>
        <span class="c1"># identified by its UUID</span>
        <span class="n">axis_type</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;date&quot;</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">dtypes</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">is_datetime64_any_dtype</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span> <span class="s2">&quot;linear&quot;</span>
        <span class="p">)</span>

        <span class="n">default_n_samples</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">max_n_samples</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">default_n_samples</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">max_n_samples</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_n_shown_samples</span>

        <span class="n">default_downsampler</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">downsampler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">default_downsampler</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">downsampler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_downsampler</span>

        <span class="n">default_gap_handler</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">gap_handler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">default_gap_handler</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">gap_handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_gap_handler</span>

        <span class="c1"># TODO -&gt; can&#39;t we just store the DC here (might be less duplication of</span>
        <span class="c1">#  code knowledge, because now, you need to know all the eligible hf_keys in</span>
        <span class="c1">#  dc</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;max_n_samples&quot;</span><span class="p">:</span> <span class="n">max_n_samples</span><span class="p">,</span>
            <span class="s2">&quot;default_n_samples&quot;</span><span class="p">:</span> <span class="n">default_n_samples</span><span class="p">,</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">trace</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;axis_type&quot;</span><span class="p">:</span> <span class="n">axis_type</span><span class="p">,</span>
            <span class="s2">&quot;downsampler&quot;</span><span class="p">:</span> <span class="n">downsampler</span><span class="p">,</span>
            <span class="s2">&quot;default_downsampler&quot;</span><span class="p">:</span> <span class="n">default_downsampler</span><span class="p">,</span>
            <span class="s2">&quot;gap_handler&quot;</span><span class="p">:</span> <span class="n">gap_handler</span><span class="p">,</span>
            <span class="s2">&quot;default_gap_handler&quot;</span><span class="p">:</span> <span class="n">default_gap_handler</span><span class="p">,</span>
            <span class="o">**</span><span class="n">dc</span><span class="o">.</span><span class="n">_asdict</span><span class="p">(),</span>
        <span class="p">}</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_add_trace_to_add_traces_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert the `add_trace` kwargs to the `add_traces` kwargs.&quot;&quot;&quot;</span>
        <span class="c1"># The keywords that need to be converted to a list</span>
        <span class="n">convert_keywords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;row&quot;</span><span class="p">,</span> <span class="s2">&quot;col&quot;</span><span class="p">,</span> <span class="s2">&quot;secondary_y&quot;</span><span class="p">]</span>

        <span class="n">updated_kwargs</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># The updated kwargs (from `add_trace` to `add_traces`)</span>
        <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">convert_keywords</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">updated_kwargs</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">keyword</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">updated_kwargs</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">keyword</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="n">kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">updated_kwargs</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">add_trace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">trace</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseTraceType</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
        <span class="n">max_n_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">downsampler</span><span class="p">:</span> <span class="n">AbstractAggregator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">gap_handler</span><span class="p">:</span> <span class="n">AbstractGapHandler</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">limit_to_view</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="c1"># Use these if you want some speedups (and are working with really large data)</span>
        <span class="n">hf_x</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hf_y</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hf_text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hf_hovertext</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hf_marker_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hf_marker_color</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">check_nans</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">trace_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a trace to the figure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        trace : BaseTraceType or dict</span>
<span class="sd">            Either:</span>

<span class="sd">              - An instances of a trace class from the ``plotly.graph_objects`` (go)</span>
<span class="sd">                package (e.g., ``go.Scatter``, ``go.Bar``)</span>
<span class="sd">              - or a dict where:</span>

<span class="sd">                - The type property specifies the trace type (e.g. scatter, bar,</span>
<span class="sd">                  area, etc.). If the dict has no &#39;type&#39; property then scatter is</span>
<span class="sd">                  assumed.</span>
<span class="sd">                - All remaining properties are passed to the constructor</span>
<span class="sd">                  of the specified trace type.</span>
<span class="sd">        max_n_samples : int, optional</span>
<span class="sd">            The maximum number of samples that will be shown by the trace.\n</span>
<span class="sd">            !!! note</span>
<span class="sd">                If this variable is not set; ``_global_n_shown_samples`` will be used.</span>
<span class="sd">        downsampler: AbstractAggregator, optional</span>
<span class="sd">            The abstract series downsampler method.\n</span>
<span class="sd">            !!! note</span>
<span class="sd">                If this variable is not set, ``_global_downsampler`` will be used.</span>
<span class="sd">        gap_handler: AbstractGapHandler, optional</span>
<span class="sd">            The abstract series gap handler method.\n</span>
<span class="sd">            !!! note</span>
<span class="sd">                If this variable is not set, ``_global_gap_handler`` will be used.</span>
<span class="sd">        limit_to_view: boolean, optional</span>
<span class="sd">            If set to True, the trace&#39;s datapoints will be cut to the corresponding</span>
<span class="sd">            front-end view, even if the total number of samples is lower than</span>
<span class="sd">            ``max_n_samples``, By default False.\n</span>
<span class="sd">            Remark that setting this parameter to True ensures that low frequency traces</span>
<span class="sd">            are added to the ``hf_data`` property.</span>
<span class="sd">        hf_x: Iterable, optional</span>
<span class="sd">            The original high frequency series positions, can be either a time-series or</span>
<span class="sd">            an increasing, numerical index. If set, this has priority over the trace its</span>
<span class="sd">            data.</span>
<span class="sd">        hf_y: Iterable, optional</span>
<span class="sd">            The original high frequency values. If set, this has priority over the</span>
<span class="sd">            trace its data.</span>
<span class="sd">        hf_text: Iterable, optional</span>
<span class="sd">            The original high frequency text. If set, this has priority over the trace</span>
<span class="sd">            its ``text`` argument.</span>
<span class="sd">        hf_hovertext: Iterable, optional</span>
<span class="sd">            The original high frequency hovertext. If set, this has priority over the</span>
<span class="sd">            trace its ```hovertext`` argument.</span>
<span class="sd">        hf_marker_size: Iterable, optional</span>
<span class="sd">            The original high frequency marker size. If set, this has priority over the</span>
<span class="sd">            trace its ``marker.size`` argument.</span>
<span class="sd">        hf_marker_color: Iterable, optional</span>
<span class="sd">            The original high frequency marker color. If set, this has priority over the</span>
<span class="sd">            trace its ``marker.color`` argument.</span>
<span class="sd">        check_nans: boolean, optional</span>
<span class="sd">            If set to True, the trace&#39;s data will be checked for NaNs - which will be</span>
<span class="sd">            removed. By default True.</span>
<span class="sd">            As this is a costly operation, it is recommended to set this parameter to</span>
<span class="sd">            False if you are sure that your data does not contain NaNs (or when the</span>
<span class="sd">            downsampler can handle NaNs, e.g., EveryNthPoint). This should considerably</span>
<span class="sd">            speed up the graph construction time.</span>
<span class="sd">        **trace_kwargs: dict</span>
<span class="sd">            Additional trace related keyword arguments.</span>
<span class="sd">            e.g.: row=.., col=..., secondary_y=...</span>

<span class="sd">            !!! info &quot;See Also&quot;</span>
<span class="sd">                [`Figure.add_trace`](https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html#plotly.graph_objects.Figure.add_trace&gt;) docs.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        BaseFigure</span>
<span class="sd">            The Figure on which ``add_trace`` was called on; i.e. self.</span>

<span class="sd">        !!! note</span>

<span class="sd">            Constructing traces with **very large data amounts** really takes some time.</span>
<span class="sd">            To speed this up; use this [`add_trace`][figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace] method and</span>

<span class="sd">            1. Create a trace with no data (empty lists)</span>
<span class="sd">            2. pass the high frequency data to this method using the ``hf_x`` and ``hf_y``</span>
<span class="sd">               parameters.</span>

<span class="sd">            See the example below:</span>
<span class="sd">                ```python</span>
<span class="sd">                &gt;&gt;&gt; from plotly.subplots import make_subplots</span>
<span class="sd">                &gt;&gt;&gt; s = pd.Series()  # a high-frequency series, with more than 1e7 samples</span>
<span class="sd">                &gt;&gt;&gt; fig = FigureResampler(go.Figure())</span>
<span class="sd">                &gt;&gt;&gt; fig.add_trace(go.Scattergl(x=[], y=[], ...), hf_x=s.index, hf_y=s)</span>
<span class="sd">                ```</span>

<span class="sd">            !!! todo</span>
<span class="sd">                * explain why adding x and y to a trace is so slow</span>
<span class="sd">                * check and simplify the example above</span>

<span class="sd">        !!! tip</span>

<span class="sd">            * If you **do not want to downsample** your data, set ``max_n_samples`` to the</span>
<span class="sd">              the number of datapoints of your trace!</span>

<span class="sd">        !!! warning</span>

<span class="sd">            * The ``NaN`` values in either ``hf_y`` or ``trace.y`` will be omitted! We do</span>
<span class="sd">              not allow ``NaN`` values in ``hf_x`` or ``trace.x``.</span>
<span class="sd">            * ``hf_x``, ``hf_y``, ``hf_text``, and ``hf_hovertext`` are useful when you deal</span>
<span class="sd">              with large amounts of data (as it can increase the speed of this add_trace()</span>
<span class="sd">              method with ~30%). These arguments have priority over the trace&#39;s data and</span>
<span class="sd">              (hover)text attributes.</span>
<span class="sd">            * Low-frequency time-series data, i.e. traces that are not resampled, can hinder</span>
<span class="sd">              the the automatic-zooming (y-scaling) as these will not be stored in the</span>
<span class="sd">              back-end and thus not be scaled to the view.</span>
<span class="sd">              To circumvent this, the ``limit_to_view`` argument can be set, resulting in</span>
<span class="sd">              also storing the low-frequency series in the back-end.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># to comply with the plotly data input acceptance behavior</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Trace must be either a dict or a BaseTraceType&quot;</span><span class="p">)</span>

        <span class="n">max_out_s</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_global_n_shown_samples</span> <span class="k">if</span> <span class="n">max_n_samples</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">max_n_samples</span>
        <span class="p">)</span>

        <span class="c1"># Validate the trace and convert to a trace object</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">BaseTraceType</span><span class="p">):</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_validator</span><span class="o">.</span><span class="n">validate_coerce</span><span class="p">(</span><span class="n">trace</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># First add a UUID, as each (even the non-hf_data traces), must contain this</span>
        <span class="c1"># key for comparison. If the trace already has a UUID, we will keep it.</span>
        <span class="n">uuid_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span> <span class="k">if</span> <span class="n">trace</span><span class="o">.</span><span class="n">uid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">trace</span><span class="o">.</span><span class="n">uid</span>
        <span class="n">trace</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="n">uuid_str</span>

        <span class="c1"># construct the hf_data_container</span>
        <span class="c1"># TODO in future version -&gt; maybe regex on kwargs which start with `hf_`</span>
        <span class="n">dc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_get_trace_props</span><span class="p">(</span>
            <span class="n">trace</span><span class="p">,</span>
            <span class="n">hf_x</span><span class="p">,</span>
            <span class="n">hf_y</span><span class="p">,</span>
            <span class="n">hf_text</span><span class="p">,</span>
            <span class="n">hf_hovertext</span><span class="p">,</span>
            <span class="n">hf_marker_size</span><span class="p">,</span>
            <span class="n">hf_marker_color</span><span class="p">,</span>
            <span class="n">check_nans</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># These traces will determine the autoscale its RANGE!</span>
        <span class="c1">#   -&gt; so also store when `limit_to_view` is set.</span>
        <span class="k">if</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_high_frequency_traces</span><span class="p">:</span>
            <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n_samples</span> <span class="o">&gt;</span> <span class="n">max_out_s</span> <span class="ow">or</span> <span class="n">limit_to_view</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">[i] DOWNSAMPLE </span><span class="si">{</span><span class="n">trace</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">n_samples</span><span class="si">}</span><span class="s2">-&gt;</span><span class="si">{</span><span class="n">max_out_s</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_hf_data</span><span class="p">[</span><span class="n">uuid_str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_hf_data_dict</span><span class="p">(</span>
                    <span class="n">dc</span><span class="p">,</span>
                    <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span>
                    <span class="n">downsampler</span><span class="o">=</span><span class="n">downsampler</span><span class="p">,</span>
                    <span class="n">gap_handler</span><span class="o">=</span><span class="n">gap_handler</span><span class="p">,</span>
                    <span class="n">max_n_samples</span><span class="o">=</span><span class="n">max_n_samples</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="c1"># Before we update the trace, we create a new pointer to that trace in</span>
                <span class="c1"># which the downsampled data will be stored. This way, the original</span>
                <span class="c1"># data of the trace to this `add_trace` method will not be altered.</span>
                <span class="c1"># We copy (by reference) all the non-data properties of the trace in</span>
                <span class="c1"># the new trace.</span>
                <span class="n">trace</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">_props</span>  <span class="c1"># convert the trace into a dict</span>
                <span class="c1"># NOTE: there is no need to store `marker` property here.</span>
                <span class="c1"># If needed, it will be added  to `trace` via `check_update_trace_data`</span>
                <span class="n">trace</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">k</span><span class="p">:</span> <span class="n">trace</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">_fields</span><span class="p">))</span>
                <span class="p">}</span>

                <span class="c1"># NOTE:</span>
                <span class="c1"># If all the raw data needs to be sent to the javascript, and the trace</span>
                <span class="c1"># is high-frequency, this would take significant time!</span>
                <span class="c1"># Hence, you first downsample the trace.</span>
                <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_update_trace_data</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
                <span class="k">assert</span> <span class="n">trace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">AbstractFigureAggregator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_traces</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">trace</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_add_trace_to_add_traces_kwargs</span><span class="p">(</span><span class="n">trace_kwargs</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[i] NOT resampling </span><span class="si">{</span><span class="n">trace</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> - len=</span><span class="si">{</span><span class="n">n_samples</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">trace</span><span class="o">.</span><span class="n">_process_kwargs</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dc</span><span class="o">.</span><span class="n">_fields</span><span class="p">})</span>
                <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">AbstractFigureAggregator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_traces</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">trace</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_add_trace_to_add_traces_kwargs</span><span class="p">(</span><span class="n">trace_kwargs</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_figure_class</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_traces</span><span class="p">(</span>
            <span class="p">[</span><span class="n">trace</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_add_trace_to_add_traces_kwargs</span><span class="p">(</span><span class="n">trace_kwargs</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_traces</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">BaseTraceType</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">|</span> <span class="n">BaseTraceType</span> <span class="o">|</span> <span class="n">Dict</span><span class="p">,</span>
        <span class="n">max_n_samples</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">downsamplers</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="n">AbstractAggregator</span><span class="p">]</span> <span class="o">|</span> <span class="n">AbstractAggregator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">gap_handlers</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="n">AbstractGapHandler</span><span class="p">]</span> <span class="o">|</span> <span class="n">AbstractGapHandler</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">limit_to_views</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">check_nans</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">traces_kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add traces to the figure.</span>

<span class="sd">        !!! note</span>

<span class="sd">            Make sure to look at the [`add_trace`][figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace] function for more info about</span>
<span class="sd">            **speed optimization**, and dealing with not ``high-frequency`` data, but</span>
<span class="sd">            still want to resample / limit the data to the front-end view.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : List[BaseTraceType  |  dict]</span>
<span class="sd">            A list of trace specifications to be added.</span>
<span class="sd">            Trace specifications may be either:</span>

<span class="sd">              - Instances of trace classes from the plotly.graph_objs</span>
<span class="sd">                package (e.g plotly.graph_objs.Scatter, plotly.graph_objs.Bar).</span>
<span class="sd">              - Dicts where:</span>

<span class="sd">                  - The &#39;type&#39; property specifies the trace type (e.g.</span>
<span class="sd">                    &#39;scatter&#39;, &#39;bar&#39;, &#39;area&#39;, etc.). If the dict has no &#39;type&#39;</span>
<span class="sd">                    property then &#39;scatter&#39; is assumed.</span>
<span class="sd">                  - All remaining properties are passed to the constructor</span>
<span class="sd">                    of the specified trace type.</span>
<span class="sd">        max_n_samples : None | List[int] | int, optional</span>
<span class="sd">              The maximum number of samples that will be shown for each trace.</span>
<span class="sd">              If a single integer is passed, all traces will use this number. If this</span>
<span class="sd">              variable is not set; ``_global_n_shown_samples`` will be used.</span>
<span class="sd">        downsamplers : None | List[AbstractAggregator] | AbstractAggregator, optional</span>
<span class="sd">            The downsampler that will be used to aggregate the traces. If a single</span>
<span class="sd">            aggregator is passed, all traces will use this aggregator.</span>
<span class="sd">            If this variable is not set, ``_global_downsampler`` will be used.</span>
<span class="sd">        gap_handlers : None | List[AbstractGapHandler] | AbstractGapHandler, optional</span>
<span class="sd">            The gap handler that will be used to aggregate the traces. If a single</span>
<span class="sd">            gap handler is passed, all traces will use this gap handler.</span>
<span class="sd">            If this variable is not set, ``_global_gap_handler`` will be used.</span>
<span class="sd">        limit_to_views : None | List[bool] | bool, optional</span>
<span class="sd">            List of limit_to_view booleans for the added traces. If set to True the</span>
<span class="sd">            trace&#39;s datapoints will be cut to the corresponding front-end view, even if</span>
<span class="sd">            the total number of samples is lower than ``max_n_samples``.</span>
<span class="sd">            If a single boolean is passed, all to be added traces will use this value,</span>
<span class="sd">            by default False.\n</span>
<span class="sd">            Remark that setting this parameter to True ensures that low frequency traces</span>
<span class="sd">            are added to the ``hf_data`` property.</span>
<span class="sd">        check_nans : None | List[bool] | bool, optional</span>
<span class="sd">            List of check_nans booleans for the added traces. If set to True, the</span>
<span class="sd">            trace&#39;s datapoints will be checked for NaNs. If a single boolean is passed,</span>
<span class="sd">            all to be added traces will use this value, by default True.\n</span>
<span class="sd">            As this is a costly operation, it is recommended to set this parameter to</span>
<span class="sd">            False if the data is known to contain no NaNs (or when the downsampler can</span>
<span class="sd">            handle NaNs, e.g., EveryNthPoint). This will considerably speed up the graph</span>
<span class="sd">            construction time.</span>
<span class="sd">        **traces_kwargs: dict</span>
<span class="sd">            Additional trace related keyword arguments.</span>
<span class="sd">            e.g.: rows=.., cols=..., secondary_ys=...</span>

<span class="sd">            !!! info &quot;See Also&quot;</span>

<span class="sd">                [`Figure.add_traces`](https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html#plotly.graph_objects.Figure.add_traces&gt;) docs.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        BaseFigure</span>
<span class="sd">            The Figure on which ``add_traces`` was called on; i.e. self.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># note: Plotly its add_traces also a allows non list-like input e.g. a scatter</span>
        <span class="c1"># object; the code below is an exact copy of their internally applied parsing</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span>

        <span class="c1"># Convert each trace into a BaseTraceType object</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data_validator</span><span class="o">.</span><span class="n">validate_coerce</span><span class="p">(</span><span class="n">trace</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">BaseTraceType</span><span class="p">)</span>
            <span class="k">else</span> <span class="n">trace</span>
            <span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">data</span>
        <span class="p">]</span>

        <span class="c1"># First add a UUID, as each (even the non-hf_data traces), must contain this</span>
        <span class="c1"># key for comparison. If the trace already has a UUID, we will keep it.</span>
        <span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">uuid_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span> <span class="k">if</span> <span class="n">trace</span><span class="o">.</span><span class="n">uid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">trace</span><span class="o">.</span><span class="n">uid</span>
            <span class="n">trace</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="n">uuid_str</span>

        <span class="c1"># Convert the data properties</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_n_samples</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">max_n_samples</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_n_samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">max_n_samples</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">downsamplers</span><span class="p">,</span> <span class="n">AbstractAggregator</span><span class="p">)</span> <span class="ow">or</span> <span class="n">downsamplers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">downsamplers</span> <span class="o">=</span> <span class="p">[</span><span class="n">downsamplers</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gap_handlers</span><span class="p">,</span> <span class="n">AbstractGapHandler</span><span class="p">)</span> <span class="ow">or</span> <span class="n">gap_handlers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">gap_handlers</span> <span class="o">=</span> <span class="p">[</span><span class="n">gap_handlers</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">limit_to_views</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">limit_to_views</span> <span class="o">=</span> <span class="p">[</span><span class="n">limit_to_views</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">check_nans</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">check_nans</span> <span class="o">=</span> <span class="p">[</span><span class="n">check_nans</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="n">zipped</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">max_n_samples</span><span class="p">,</span> <span class="n">downsamplers</span><span class="p">,</span> <span class="n">gap_handlers</span><span class="p">,</span> <span class="n">limit_to_views</span><span class="p">,</span> <span class="n">check_nans</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span>
            <span class="n">i</span><span class="p">,</span>
            <span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">max_out</span><span class="p">,</span> <span class="n">downsampler</span><span class="p">,</span> <span class="n">gap_handler</span><span class="p">,</span> <span class="n">limit_to_view</span><span class="p">,</span> <span class="n">check_nan</span><span class="p">),</span>
        <span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">zipped</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">trace</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_high_frequency_traces</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hf_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">):</span>
                <span class="k">continue</span>

            <span class="n">max_out_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_n_shown_samples</span> <span class="k">if</span> <span class="n">max_out</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">max_out</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">limit_to_view</span> <span class="ow">and</span> <span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_out_s</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="n">dc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_get_trace_props</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">check_nans</span><span class="o">=</span><span class="n">check_nan</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hf_data</span><span class="p">[</span><span class="n">trace</span><span class="o">.</span><span class="n">uid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_hf_data_dict</span><span class="p">(</span>
                <span class="n">dc</span><span class="p">,</span>
                <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span>
                <span class="n">downsampler</span><span class="o">=</span><span class="n">downsampler</span><span class="p">,</span>
                <span class="n">gap_handler</span><span class="o">=</span><span class="n">gap_handler</span><span class="p">,</span>
                <span class="n">max_n_samples</span><span class="o">=</span><span class="n">max_out</span><span class="p">,</span>
                <span class="n">offset</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># convert the trace into a dict, and only withholds the non-hf props</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">_props</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">trace</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">_fields</span><span class="p">))}</span>

            <span class="c1"># update the trace data with the HF props</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_update_trace_data</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">trace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">trace</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_figure_class</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_traces</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">traces_kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_clear_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clear the current figure object its data and layout.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hf_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layout</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">_copy_hf_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hf_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">adjust_default_values</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Copy (i.e. create a new key reference, not a deep copy) of a hf_data dict.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hf_data : dict</span>
<span class="sd">            The hf_data dict, having the trace &#39;uid&#39; as key and the</span>
<span class="sd">            hf-data, together with its aggregation properties as dict-values</span>
<span class="sd">        adjust_default_values: bool</span>
<span class="sd">            Whether the default values (of the downsampler, max # shown samples) will</span>
<span class="sd">            be adjusted according to the values of this object, by default False</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            The copied (&amp; default values adjusted) output dict.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">hf_data_cp</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">uid</span><span class="p">:</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">hf_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">hf_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())}</span>
            <span class="k">for</span> <span class="n">uid</span><span class="p">,</span> <span class="n">hf_dict</span> <span class="ow">in</span> <span class="n">hf_data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="c1"># Adjust the default arguments to the current argument values</span>
        <span class="k">if</span> <span class="n">adjust_default_values</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">hf_props</span> <span class="ow">in</span> <span class="n">hf_data_cp</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">hf_props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default_downsampler&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">hf_props</span><span class="p">[</span><span class="s2">&quot;downsampler&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_downsampler</span>
                <span class="k">if</span> <span class="n">hf_props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default_gap_handler&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">hf_props</span><span class="p">[</span><span class="s2">&quot;gap_handler&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_gap_handler</span>
                <span class="k">if</span> <span class="n">hf_props</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;default_n_samples&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">hf_props</span><span class="p">[</span><span class="s2">&quot;max_n_samples&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_n_shown_samples</span>

        <span class="k">return</span> <span class="n">hf_data_cp</span>

    <span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">convert_existing_traces</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Replace the current figure layout with the passed figure object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        figure: go.Figure</span>
<span class="sd">            The figure object which will replace the existing figure.</span>
<span class="sd">        convert_existing_traces: bool, Optional</span>
<span class="sd">            A bool indicating whether the traces of the passed ``figure`` should be</span>
<span class="sd">            resampled, by default True.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_clear_figure</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">figure</span><span class="o">=</span><span class="n">figure</span><span class="p">,</span>
            <span class="n">convert_existing_traces</span><span class="o">=</span><span class="n">convert_existing_traces</span><span class="p">,</span>
            <span class="n">default_n_shown_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_global_n_shown_samples</span><span class="p">,</span>
            <span class="n">default_downsampler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_global_downsampler</span><span class="p">,</span>
            <span class="n">default_gap_handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_global_gap_handler</span><span class="p">,</span>
            <span class="n">resampled_trace_prefix_suffix</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suffix</span><span class="p">),</span>
            <span class="n">show_mean_aggregation_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_show_mean_aggregation_size</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_verbose</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_relayout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relayout_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the relayout object so that the autorange will be set to None when</span>
<span class="sd">        there are xy-matches.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        relayout_dict : dict</span>
<span class="sd">            The relayout dictionary.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># 1. Create a new dict with additional layout updates for the front-end</span>
        <span class="n">extra_layout_updates</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># 1.1. Set autorange to False for each layout item with a specified x-range</span>
        <span class="n">xy_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_re_matches</span><span class="p">(</span>
            <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[xy]axis\d*.range\[\d+]&quot;</span><span class="p">),</span> <span class="n">relayout_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">range_change_axis</span> <span class="ow">in</span> <span class="n">xy_matches</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">range_change_axis</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">extra_layout_updates</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2">.autorange&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">extra_layout_updates</span>

    <span class="k">def</span> <span class="nf">construct_update_data_patch</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">relayout_data</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">dash</span><span class="o">.</span><span class="n">Patch</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct the Patch of the to-be-updated front-end data, based on the layout</span>
<span class="sd">        change.</span>

<span class="sd">        Attention</span>
<span class="sd">        ---------</span>
<span class="sd">        This method is tightly coupled with Dash app callbacks. It takes the front-end</span>
<span class="sd">        figure its ``relayoutData`` as input and returns the ``dash.Patch`` which needs</span>
<span class="sd">        to be sent to the ``figure`` property for the corresponding ``dcc.Graph``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        relayout_data: dict</span>
<span class="sd">            A dict containing the ``relayoutData`` (i.e., the changed layout data) of</span>
<span class="sd">            the corresponding front-end graph.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dash.Patch:</span>
<span class="sd">            The Patch object containing the figure updates which needs to be sent to</span>
<span class="sd">            the front-end.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">update_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_update_data</span><span class="p">(</span><span class="n">relayout_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">update_data</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">update_data</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span>

        <span class="n">patched_figure</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Patch</span><span class="p">()</span>  <span class="c1"># create patch</span>
        <span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">update_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>  <span class="c1"># skip first item as it contains the relayout</span>
            <span class="n">trace_index</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>  <span class="c1"># the index of the corresponding trace</span>
            <span class="c1"># All the other items are the trace properties which needs to be updated</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">trace</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="c1"># NOTE: we need to use the `patched_figure` as a dict, and not</span>
                <span class="c1"># `patched_figure.data` as the latter will replace **all** the</span>
                <span class="c1"># data for the corresponding trace, and we just want to update the</span>
                <span class="c1"># specific trace its properties.</span>
                <span class="n">patched_figure</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="n">trace_index</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">patched_figure</span>

    <span class="k">def</span> <span class="nf">_construct_update_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">relayout_data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct the to-be-updated front-end data, based on the layout change.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        relayout_data: dict</span>
<span class="sd">            A dict containing the ``relayoutData`` (i.e., the changed layout data) of</span>
<span class="sd">            the corresponding front-end graph.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        List[dict]:</span>
<span class="sd">            A list of dicts, where each dict-item is a representation of a trace its</span>
<span class="sd">            *data* properties which are affected by the front-end layout change. |br|</span>
<span class="sd">            In other words, only traces which need to be updated will be sent to the</span>
<span class="sd">            front-end. Additionally, each trace-dict withholds the *index* of its</span>
<span class="sd">            corresponding position in the ``figure[data]`` array with the ``index``-key</span>
<span class="sd">            in each dict.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_current_graph</span><span class="p">()</span>
        <span class="n">updated_trace_indices</span><span class="p">,</span> <span class="n">cl_k</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">relayout_data</span><span class="p">:</span>
            <span class="c1"># flatten the possibly nested dict using &#39;.&#39; as separator</span>
            <span class="n">relayout_data</span> <span class="o">=</span> <span class="n">nested_to_record</span><span class="p">(</span><span class="n">relayout_data</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;changed layout&quot;</span><span class="p">,</span> <span class="n">relayout_data</span><span class="p">)</span>

            <span class="n">cl_k</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">relayout_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

            <span class="c1"># ------------------ HF DATA aggregation ---------------------</span>
            <span class="c1"># 1. Base case - there is an x-range specified in the front-end</span>
            <span class="n">start_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_re_matches</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;xaxis\d*.range\[0]&quot;</span><span class="p">),</span> <span class="n">cl_k</span><span class="p">)</span>
            <span class="n">stop_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_re_matches</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;xaxis\d*.range\[1]&quot;</span><span class="p">),</span> <span class="n">cl_k</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">start_matches</span> <span class="ow">and</span> <span class="n">stop_matches</span><span class="p">:</span>  <span class="c1"># when both are not empty</span>
                <span class="k">for</span> <span class="n">t_start_key</span><span class="p">,</span> <span class="n">t_stop_key</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">start_matches</span><span class="p">,</span> <span class="n">stop_matches</span><span class="p">):</span>
                    <span class="c1"># Check if the xaxis&lt;NUMB&gt; part of xaxis&lt;NUMB&gt;.[0-1] matches</span>
                    <span class="n">xaxis</span> <span class="o">=</span> <span class="n">t_start_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">assert</span> <span class="n">xaxis</span> <span class="o">==</span> <span class="n">t_stop_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="c1"># -&gt; we want to copy the layout on the back-end</span>
                    <span class="n">updated_trace_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_update_figure_dict</span><span class="p">(</span>
                        <span class="n">current_graph</span><span class="p">,</span>
                        <span class="n">start</span><span class="o">=</span><span class="n">relayout_data</span><span class="p">[</span><span class="n">t_start_key</span><span class="p">],</span>
                        <span class="n">stop</span><span class="o">=</span><span class="n">relayout_data</span><span class="p">[</span><span class="n">t_stop_key</span><span class="p">],</span>
                        <span class="n">layout_xaxis_filter</span><span class="o">=</span><span class="n">xaxis</span><span class="p">,</span>
                        <span class="n">updated_trace_indices</span><span class="o">=</span><span class="n">updated_trace_indices</span><span class="p">,</span>
                    <span class="p">)</span>

            <span class="c1"># 2. The user clicked on either autorange | reset axes</span>
            <span class="n">autorange_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_re_matches</span><span class="p">(</span>
                <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;xaxis\d*.autorange&quot;</span><span class="p">),</span> <span class="n">cl_k</span>
            <span class="p">)</span>
            <span class="n">spike_matches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_re_matches</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;xaxis\d*.showspikes&quot;</span><span class="p">),</span> <span class="n">cl_k</span><span class="p">)</span>
            <span class="c1"># 2.1 Reset-axes -&gt; autorange &amp; reset to the global data view</span>
            <span class="k">if</span> <span class="n">autorange_matches</span> <span class="ow">and</span> <span class="n">spike_matches</span><span class="p">:</span>  <span class="c1"># when both are not empty</span>
                <span class="k">for</span> <span class="n">autorange_key</span> <span class="ow">in</span> <span class="n">autorange_matches</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">relayout_data</span><span class="p">[</span><span class="n">autorange_key</span><span class="p">]:</span>
                        <span class="n">xaxis</span> <span class="o">=</span> <span class="n">autorange_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">updated_trace_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_update_figure_dict</span><span class="p">(</span>
                            <span class="n">current_graph</span><span class="p">,</span>
                            <span class="n">layout_xaxis_filter</span><span class="o">=</span><span class="n">xaxis</span><span class="p">,</span>
                            <span class="n">updated_trace_indices</span><span class="o">=</span><span class="n">updated_trace_indices</span><span class="p">,</span>
                        <span class="p">)</span>
            <span class="c1"># 2.1. Autorange -&gt; do nothing, the autorange will be applied on the</span>
            <span class="c1">#      current front-end view</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">autorange_matches</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">spike_matches</span>
            <span class="p">):</span>  <span class="c1"># when only autorange is not empty</span>
                <span class="c1"># PreventUpdate returns a 204 status code response on the</span>
                <span class="c1"># relayout post request</span>
                <span class="k">return</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span>

        <span class="c1"># If we do not have any traces to be updated, we will return an empty</span>
        <span class="c1"># request response</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">updated_trace_indices</span><span class="p">:</span>  <span class="c1"># when updated_trace_indices is empty</span>
            <span class="c1"># PreventUpdate returns a 204 status-code response on the relayout post</span>
            <span class="c1"># request</span>
            <span class="k">return</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span>

        <span class="c1"># -------------------- construct callback data --------------------------</span>
        <span class="c1"># 1. Create the layout data for the front-end</span>
        <span class="n">layout_traces_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">relayout_data</span><span class="p">]</span>

        <span class="c1"># 2. Create the additional trace data for the frond-end</span>
        <span class="n">relevant_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">_hf_data_container</span><span class="o">.</span><span class="n">_fields</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;marker&quot;</span><span class="p">]</span>
        <span class="c1"># Note that only updated trace-data will be sent to the client</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">updated_trace_indices</span><span class="p">:</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="n">current_graph</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
            <span class="c1"># TODO: check if we can reduce even more</span>
            <span class="n">trace_reduced</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">trace</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">relevant_keys</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">trace</span><span class="p">}</span>

            <span class="c1"># Store the index into the corresponding to-be-sent trace-data so</span>
            <span class="c1"># the client front-end can know which trace needs to be updated</span>
            <span class="n">trace_reduced</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="n">idx</span><span class="p">})</span>

            <span class="n">layout_traces_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trace_reduced</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">layout_traces_list</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_parse_dtype_orjson</span><span class="p">(</span><span class="n">series</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Verify the orjson compatibility of the series and convert it if needed.&quot;&quot;&quot;</span>
        <span class="c1"># NOTE:</span>
        <span class="c1">#    * float16 and float128 aren&#39;t supported with latest orjson versions (3.8.1)</span>
        <span class="c1">#    * this method assumes that the it will not get a float128 series</span>
        <span class="c1"># -&gt; this method can be removed if orjson supports float16</span>
        <span class="k">if</span> <span class="n">series</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">series</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">series</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_re_matches</span><span class="p">(</span><span class="n">regex</span><span class="p">:</span> <span class="n">re</span><span class="o">.</span><span class="n">Pattern</span><span class="p">,</span> <span class="n">strings</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all the items in ``strings`` which regex.match(es) ``regex``.&quot;&quot;&quot;</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">strings</span><span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">regex</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">matches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">matches</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_is_no_update</span><span class="p">(</span><span class="n">update_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">update_data</span> <span class="ow">is</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span>

    <span class="c1"># ------------------------------- Magic methods ---------------------------------</span>

    <span class="k">def</span> <span class="nf">_get_pr_props_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the keys (i.e., the names) of the plotly-resampler properties.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        This method is used to serialize the object in the `__reduce__` method.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="s2">&quot;_hf_data&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_global_n_shown_samples&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_print_verbose&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_show_mean_aggregation_size&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_prefix&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_suffix&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_global_downsampler&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_global_gap_handler&quot;</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Overwrite the reduce method (which is used to support deep copying and</span>
<span class="sd">        pickling).</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        We do not overwrite the `to_dict` method, as this is used to send the figure</span>
<span class="sd">        to the frontend (and thus should not capture the plotly-resampler properties).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">props</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__reduce__</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>  <span class="c1"># I don&#39;t know why this would be &gt; 1</span>
        <span class="n">props</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Add the plotly-resampler properties</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;pr_props&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pr_props_keys</span><span class="p">():</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;pr_props&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="p">(</span><span class="n">props</span><span class="p">,)</span>  <span class="c1"># (props,) to comply with plotly magic</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h3 id="figure_resampler.figure_resampler_interface.AbstractFigureAggregator.hf_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">hf_data</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.hf_data" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Property to adjust the <code>data</code> component of the current graph</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user has full responsibility to adjust <code>hf_data</code> properly.</p>
</div>
<details class="example">
<summary>Example</summary>
<div class="highlight"><pre><span></span><code>    <span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">plotly_resampler</span> <span class="kn">import</span> <span class="n">FigureResampler</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">FigureResampler</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">())</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="c1"># Adjust the y property of the above added trace</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="o">.</span><span class="n">hf_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="n">s</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="o">.</span><span class="n">hf_data</span>
    <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;max_n_samples&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
            <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">11000000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.01339909</span><span class="p">,</span>  <span class="mf">0.01390696</span><span class="p">,,</span> <span class="o">...</span><span class="p">,</span>  <span class="mf">0.25051913</span><span class="p">,</span> <span class="mf">0.55876513</span><span class="p">]),</span>
            <span class="s1">&#39;axis_type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
            <span class="s1">&#39;downsampler&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">plotly_resampler</span><span class="o">.</span><span class="n">aggregation</span><span class="o">.</span><span class="n">aggregators</span><span class="o">.</span><span class="n">LTTB</span> <span class="n">at</span> <span class="mh">0x7f786d5a9ca0</span><span class="o">&gt;</span><span class="p">,</span>
            <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="s1">&#39;hovertext&#39;</span><span class="p">:</span> <span class="kc">None</span>
        <span class="p">},</span>
    <span class="p">]</span>
</code></pre></div>
</details>
  </div>

</div>




<div class="doc doc-object doc-function">




<h3 id="figure_resampler.figure_resampler_interface.AbstractFigureAggregator.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">convert_existing_traces</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default_n_shown_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">default_downsampler</span><span class="o">=</span><span class="n">MinMaxLTTB</span><span class="p">(),</span> <span class="n">default_gap_handler</span><span class="o">=</span><span class="n">MedDiffGapHandler</span><span class="p">(),</span> <span class="n">resampled_trace_prefix_suffix</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;&lt;b style=&quot;color:sandybrown&quot;&gt;[R]&lt;/b&gt; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">show_mean_aggregation_size</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">convert_traces_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Instantiate a resampling data mirror.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>figure</code></td>
          <td>
                <code><span title="plotly.basedatatypes.BaseFigure">BaseFigure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The figure that will be decorated. Can be either an empty figure
(e.g., <code>go.Figure()</code>, <code>make_subplots()</code>, <code>go.FigureWidget</code>) or an
existing figure.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>convert_existing_traces</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A bool indicating whether the high-frequency traces of the passed <code>figure</code>
should be resampled, by default True. Hence, when set to False, the
high-frequency traces of the passed <code>figure</code> will not be resampled.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>default_n_shown_samples</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The default number of samples that will be shown for each trace,
by default 1000.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>This can be overridden within the <a class="autorefs autorefs-internal" href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace"><code>add_trace</code></a> method.</li>
<li>If a trace withholds fewer datapoints than this parameter,
  the data will <em>not</em> be aggregated.</li>
</ul>
</div>
            </div>
          </td>
          <td>
                <code>1000</code>
          </td>
        </tr>
        <tr>
          <td><code>default_downsampler</code></td>
          <td>
                <code><span title="figure_resampler.aggregation.AbstractAggregator">AbstractAggregator</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An instance which implements the AbstractSeriesDownsampler interface and
will be used as default downsampler, by default <code>MinMaxLTTB</code>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This can be overridden within the <a class="autorefs autorefs-internal" href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace"><code>add_trace</code></a> method.</p>
</div>
            </div>
          </td>
          <td>
                <code><span title="figure_resampler.aggregation.MinMaxLTTB">MinMaxLTTB</span>()</code>
          </td>
        </tr>
        <tr>
          <td><code>default_gap_handler</code></td>
          <td>
                <code><span title="figure_resampler.aggregation.gap_handler_interface.AbstractGapHandler">AbstractGapHandler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>An instance which implements the AbstractGapHandler interface and will be
used as default gap handler, by default <code>MedDiffGapHandler</code>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This can be overridden within the <a class="autorefs autorefs-internal" href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace"><code>add_trace</code></a> method.</p>
</div>
            </div>
          </td>
          <td>
                <code><span title="figure_resampler.aggregation.MedDiffGapHandler">MedDiffGapHandler</span>()</code>
          </td>
        </tr>
        <tr>
          <td><code>resampled_trace_prefix_suffix</code></td>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[str, str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A tuple which contains the <code>prefix</code> and <code>suffix</code>, respectively, which
will be added to the trace its legend-name when a resampled version of the
trace is shown. By default, a bold, orange <code>[R]</code> is shown as prefix
(no suffix is shown).</p>
            </div>
          </td>
          <td>
                <code>(&#39;&lt;b style=&#34;color:sandybrown&#34;&gt;[R]&lt;/b&gt; &#39;, &#39;&#39;)</code>
          </td>
        </tr>
        <tr>
          <td><code>show_mean_aggregation_size</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether the mean aggregation bin size will be added as a suffix to the trace
its legend-name, by default True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>convert_traces_kwargs</code></td>
          <td>
                <code>dict | None</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dict of kwargs that will be passed to the <a class="autorefs autorefs-internal" href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_traces"><code>add_traces</code></a> method and
will be used to convert the existing traces. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This argument is only used when the passed <code>figure</code> contains data and
<code>convert_existing_traces</code> is set to True.</p>
</div>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>verbose</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether some verbose messages will be printed or not, by default False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>plotly_resampler/figure_resampler/figure_resampler_interface.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">figure</span><span class="p">:</span> <span class="n">BaseFigure</span><span class="p">,</span>
    <span class="n">convert_existing_traces</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">default_n_shown_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">default_downsampler</span><span class="p">:</span> <span class="n">AbstractAggregator</span> <span class="o">=</span> <span class="n">MinMaxLTTB</span><span class="p">(),</span>
    <span class="n">default_gap_handler</span><span class="p">:</span> <span class="n">AbstractGapHandler</span> <span class="o">=</span> <span class="n">MedDiffGapHandler</span><span class="p">(),</span>
    <span class="n">resampled_trace_prefix_suffix</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s1">&#39;&lt;b style=&quot;color:sandybrown&quot;&gt;[R]&lt;/b&gt; &#39;</span><span class="p">,</span>
        <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">show_mean_aggregation_size</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">convert_traces_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Instantiate a resampling data mirror.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    figure: BaseFigure</span>
<span class="sd">        The figure that will be decorated. Can be either an empty figure</span>
<span class="sd">        (e.g., ``go.Figure()``, ``make_subplots()``, ``go.FigureWidget``) or an</span>
<span class="sd">        existing figure.</span>
<span class="sd">    convert_existing_traces: bool</span>
<span class="sd">        A bool indicating whether the high-frequency traces of the passed ``figure``</span>
<span class="sd">        should be resampled, by default True. Hence, when set to False, the</span>
<span class="sd">        high-frequency traces of the passed ``figure`` will not be resampled.</span>
<span class="sd">    default_n_shown_samples: int, optional</span>
<span class="sd">        The default number of samples that will be shown for each trace,</span>
<span class="sd">        by default 1000.\n</span>
<span class="sd">        !!! note</span>
<span class="sd">            * This can be overridden within the [`add_trace`][figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace] method.</span>
<span class="sd">            * If a trace withholds fewer datapoints than this parameter,</span>
<span class="sd">              the data will *not* be aggregated.</span>
<span class="sd">    default_downsampler: AbstractAggregator</span>
<span class="sd">        An instance which implements the AbstractSeriesDownsampler interface and</span>
<span class="sd">        will be used as default downsampler, by default ``MinMaxLTTB``. \n</span>
<span class="sd">        !!! note</span>
<span class="sd">            This can be overridden within the [`add_trace`][figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace] method.</span>
<span class="sd">    default_gap_handler: GapHandler</span>
<span class="sd">        An instance which implements the AbstractGapHandler interface and will be</span>
<span class="sd">        used as default gap handler, by default ``MedDiffGapHandler``. \n</span>
<span class="sd">        !!! note</span>
<span class="sd">            This can be overridden within the [`add_trace`][figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace] method.</span>
<span class="sd">    resampled_trace_prefix_suffix: str, optional</span>
<span class="sd">        A tuple which contains the ``prefix`` and ``suffix``, respectively, which</span>
<span class="sd">        will be added to the trace its legend-name when a resampled version of the</span>
<span class="sd">        trace is shown. By default, a bold, orange ``[R]`` is shown as prefix</span>
<span class="sd">        (no suffix is shown).</span>
<span class="sd">    show_mean_aggregation_size: bool, optional</span>
<span class="sd">        Whether the mean aggregation bin size will be added as a suffix to the trace</span>
<span class="sd">        its legend-name, by default True.</span>
<span class="sd">    convert_traces_kwargs: dict, optional</span>
<span class="sd">        A dict of kwargs that will be passed to the [`add_traces`][figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_traces] method and</span>
<span class="sd">        will be used to convert the existing traces. \n</span>
<span class="sd">        !!! note</span>
<span class="sd">            This argument is only used when the passed ``figure`` contains data and</span>
<span class="sd">            ``convert_existing_traces`` is set to True.</span>
<span class="sd">    verbose: bool, optional</span>
<span class="sd">        Whether some verbose messages will be printed or not, by default False.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hf_data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_global_n_shown_samples</span> <span class="o">=</span> <span class="n">default_n_shown_samples</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_print_verbose</span> <span class="o">=</span> <span class="n">verbose</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_show_mean_aggregation_size</span> <span class="o">=</span> <span class="n">show_mean_aggregation_size</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">resampled_trace_prefix_suffix</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suffix</span> <span class="o">=</span> <span class="n">resampled_trace_prefix_suffix</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_global_downsampler</span> <span class="o">=</span> <span class="n">default_downsampler</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_global_gap_handler</span> <span class="o">=</span> <span class="n">default_gap_handler</span>

    <span class="c1"># Given figure should always be a BaseFigure that is not wrapped by</span>
    <span class="c1"># a plotly-resampler class</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">BaseFigure</span><span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="nb">issubclass</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">figure</span><span class="p">),</span> <span class="n">AbstractFigureAggregator</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_figure_class</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="vm">__class__</span>

    <span class="c1"># Overwrite the passed arguments with the property dict values</span>
    <span class="c1"># (this is the case when the PR figure is created from a pickled object)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="s2">&quot;_pr_props&quot;</span><span class="p">):</span>
        <span class="n">pr_props</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">_pr_props</span>  <span class="c1"># a dict of PR properties</span>
        <span class="k">if</span> <span class="n">pr_props</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Overwrite the default arguments with the serialized properties</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">pr_props</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="s2">&quot;_pr_props&quot;</span><span class="p">)</span>  <span class="c1"># should not be stored anymore</span>

    <span class="k">if</span> <span class="n">convert_existing_traces</span><span class="p">:</span>
        <span class="c1"># call __init__ with the correct layout and set the `_grid_ref` of the</span>
        <span class="c1"># to-be-converted figure</span>
        <span class="n">f_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figure_class</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">figure</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>
        <span class="n">f_</span><span class="o">.</span><span class="n">_grid_str</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">_grid_str</span>
        <span class="n">f_</span><span class="o">.</span><span class="n">_grid_ref</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">_grid_ref</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">f_</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">convert_traces_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">convert_traces_kwargs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># make sure that the UIDs of these traces do not get adjusted</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_validator</span><span class="o">.</span><span class="n">set_uid</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_traces</span><span class="p">(</span><span class="n">figure</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">convert_traces_kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">figure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_validator</span><span class="o">.</span><span class="n">set_uid</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># A list of al xaxis and yaxis string names</span>
    <span class="c1"># e.g., &quot;xaxis&quot;, &quot;xaxis2&quot;, &quot;xaxis3&quot;, .... for _xaxis_list</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_xaxis_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_re_matches</span><span class="p">(</span>
        <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;xaxis\d*&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layout</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_yaxis_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_re_matches</span><span class="p">(</span>
        <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;yaxis\d*&quot;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_layout</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="c1"># edge case: an empty `go.Figure()` does not yet contain axes keys</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_xaxis_list</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xaxis_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;xaxis&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_yaxis_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;yaxis&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="figure_resampler.figure_resampler_interface.AbstractFigureAggregator.__reduce__" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">__reduce__</span><span class="p">()</span></code>

<a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.__reduce__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Overwrite the reduce method (which is used to support deep copying and
pickling).</p>
<h5 id="figure_resampler.figure_resampler_interface.AbstractFigureAggregator.__reduce__--note">Note<a class="headerlink" href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.__reduce__--note" title="Permanent link">&para;</a></h5>
<p>We do not overwrite the <code>to_dict</code> method, as this is used to send the figure
to the frontend (and thus should not capture the plotly-resampler properties).</p>

          <details class="quote">
            <summary>Source code in <code>plotly_resampler/figure_resampler/figure_resampler_interface.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Overwrite the reduce method (which is used to support deep copying and</span>
<span class="sd">    pickling).</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    We do not overwrite the `to_dict` method, as this is used to send the figure</span>
<span class="sd">    to the frontend (and thus should not capture the plotly-resampler properties).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">props</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__reduce__</span><span class="p">()</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>  <span class="c1"># I don&#39;t know why this would be &gt; 1</span>
    <span class="n">props</span> <span class="o">=</span> <span class="n">props</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Add the plotly-resampler properties</span>
    <span class="n">props</span><span class="p">[</span><span class="s2">&quot;pr_props&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pr_props_keys</span><span class="p">():</span>
        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;pr_props&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="p">(</span><span class="n">props</span><span class="p">,)</span>  <span class="c1"># (props,) to comply with plotly magic</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">max_n_samples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">downsampler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gap_handler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit_to_view</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">hf_x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hf_y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hf_text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hf_hovertext</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hf_marker_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hf_marker_color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">check_nans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">trace_kwargs</span><span class="p">)</span></code>

<a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Add a trace to the figure.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>trace</code></td>
          <td>
                <code><span title="plotly.basedatatypes.BaseTraceType">BaseTraceType</span> or dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Either:</p>
<ul>
<li>An instances of a trace class from the <code>plotly.graph_objects</code> (go)
    package (e.g., <code>go.Scatter</code>, <code>go.Bar</code>)</li>
<li>
<p>or a dict where:</p>
<ul>
<li>The type property specifies the trace type (e.g. scatter, bar,
  area, etc.). If the dict has no &lsquo;type&rsquo; property then scatter is
  assumed.</li>
<li>All remaining properties are passed to the constructor
  of the specified trace type.</li>
</ul>
</li>
</ul>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>max_n_samples</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum number of samples that will be shown by the trace.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If this variable is not set; <code>_global_n_shown_samples</code> will be used.</p>
</div>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>downsampler</code></td>
          <td>
                <code><span title="figure_resampler.aggregation.AbstractAggregator">AbstractAggregator</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The abstract series downsampler method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If this variable is not set, <code>_global_downsampler</code> will be used.</p>
</div>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gap_handler</code></td>
          <td>
                <code><span title="figure_resampler.aggregation.gap_handler_interface.AbstractGapHandler">AbstractGapHandler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The abstract series gap handler method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If this variable is not set, <code>_global_gap_handler</code> will be used.</p>
</div>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>limit_to_view</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If set to True, the trace&rsquo;s datapoints will be cut to the corresponding
front-end view, even if the total number of samples is lower than
<code>max_n_samples</code>, By default False.</p>
<p>Remark that setting this parameter to True ensures that low frequency traces
are added to the <code>hf_data</code> property.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>hf_x</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The original high frequency series positions, can be either a time-series or
an increasing, numerical index. If set, this has priority over the trace its
data.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>hf_y</code></td>
          <td>
                <code><span title="typing.Iterable">Iterable</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The original high frequency values. If set, this has priority over the
trace its data.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>hf_text</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="typing.Iterable">Iterable</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The original high frequency text. If set, this has priority over the trace
its <code>text</code> argument.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>hf_hovertext</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="typing.Iterable">Iterable</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The original high frequency hovertext. If set, this has priority over the
trace its <code>`hovertext</code> argument.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>hf_marker_size</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="typing.Iterable">Iterable</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The original high frequency marker size. If set, this has priority over the
trace its <code>marker.size</code> argument.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>hf_marker_color</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, <span title="typing.Iterable">Iterable</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The original high frequency marker color. If set, this has priority over the
trace its <code>marker.color</code> argument.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>check_nans</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If set to True, the trace&rsquo;s data will be checked for NaNs - which will be
removed. By default True.
As this is a costly operation, it is recommended to set this parameter to
False if you are sure that your data does not contain NaNs (or when the
downsampler can handle NaNs, e.g., EveryNthPoint). This should considerably
speed up the graph construction time.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>**trace_kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional trace related keyword arguments.
e.g.: row=.., col=&hellip;, secondary_y=&hellip;</p>
<div class="admonition info">
<p class="admonition-title">See Also</p>
<p><a href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html#plotly.graph_objects.Figure.add_trace&gt;"><code>Figure.add_trace</code></a> docs.</p>
</div>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="plotly.basedatatypes.BaseFigure">BaseFigure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Figure on which <code>add_trace</code> was called on; i.e. self.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <div class="admonition note">
<p class="admonition-title">Note</p>
<p>Constructing traces with <strong>very large data amounts</strong> really takes some time.
To speed this up; use this <a class="autorefs autorefs-internal" href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace"><code>add_trace</code></a> method and</p>
<ol>
<li>Create a trace with no data (empty lists)</li>
<li>pass the high frequency data to this method using the <code>hf_x</code> and <code>hf_y</code>
   parameters.</li>
</ol>
<p>See the example below:
    <div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>  <span class="c1"># a high-frequency series, with more than 1e7 samples</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">FigureResampler</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scattergl</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[],</span> <span class="n">y</span><span class="o">=</span><span class="p">[],</span> <span class="o">...</span><span class="p">),</span> <span class="n">hf_x</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">hf_y</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
</code></pre></div></p>
<div class="admonition todo">
<p class="admonition-title">Todo</p>
<ul>
<li>explain why adding x and y to a trace is so slow</li>
<li>check and simplify the example above</li>
</ul>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<ul>
<li>If you <strong>do not want to downsample</strong> your data, set <code>max_n_samples</code> to the
  the number of datapoints of your trace!</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ul>
<li>The <code>NaN</code> values in either <code>hf_y</code> or <code>trace.y</code> will be omitted! We do
  not allow <code>NaN</code> values in <code>hf_x</code> or <code>trace.x</code>.</li>
<li><code>hf_x</code>, <code>hf_y</code>, <code>hf_text</code>, and <code>hf_hovertext</code> are useful when you deal
  with large amounts of data (as it can increase the speed of this add_trace()
  method with ~30%). These arguments have priority over the trace&rsquo;s data and
  (hover)text attributes.</li>
<li>Low-frequency time-series data, i.e. traces that are not resampled, can hinder
  the the automatic-zooming (y-scaling) as these will not be stored in the
  back-end and thus not be scaled to the view.
  To circumvent this, the <code>limit_to_view</code> argument can be set, resulting in
  also storing the low-frequency series in the back-end.</li>
</ul>
</div>

          <details class="quote">
            <summary>Source code in <code>plotly_resampler/figure_resampler/figure_resampler_interface.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_trace</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">trace</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BaseTraceType</span><span class="p">,</span> <span class="nb">dict</span><span class="p">],</span>
    <span class="n">max_n_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">downsampler</span><span class="p">:</span> <span class="n">AbstractAggregator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gap_handler</span><span class="p">:</span> <span class="n">AbstractGapHandler</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">limit_to_view</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="c1"># Use these if you want some speedups (and are working with really large data)</span>
    <span class="n">hf_x</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hf_y</span><span class="p">:</span> <span class="n">Iterable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hf_text</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hf_hovertext</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hf_marker_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hf_marker_color</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">check_nans</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">trace_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add a trace to the figure.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    trace : BaseTraceType or dict</span>
<span class="sd">        Either:</span>

<span class="sd">          - An instances of a trace class from the ``plotly.graph_objects`` (go)</span>
<span class="sd">            package (e.g., ``go.Scatter``, ``go.Bar``)</span>
<span class="sd">          - or a dict where:</span>

<span class="sd">            - The type property specifies the trace type (e.g. scatter, bar,</span>
<span class="sd">              area, etc.). If the dict has no &#39;type&#39; property then scatter is</span>
<span class="sd">              assumed.</span>
<span class="sd">            - All remaining properties are passed to the constructor</span>
<span class="sd">              of the specified trace type.</span>
<span class="sd">    max_n_samples : int, optional</span>
<span class="sd">        The maximum number of samples that will be shown by the trace.\n</span>
<span class="sd">        !!! note</span>
<span class="sd">            If this variable is not set; ``_global_n_shown_samples`` will be used.</span>
<span class="sd">    downsampler: AbstractAggregator, optional</span>
<span class="sd">        The abstract series downsampler method.\n</span>
<span class="sd">        !!! note</span>
<span class="sd">            If this variable is not set, ``_global_downsampler`` will be used.</span>
<span class="sd">    gap_handler: AbstractGapHandler, optional</span>
<span class="sd">        The abstract series gap handler method.\n</span>
<span class="sd">        !!! note</span>
<span class="sd">            If this variable is not set, ``_global_gap_handler`` will be used.</span>
<span class="sd">    limit_to_view: boolean, optional</span>
<span class="sd">        If set to True, the trace&#39;s datapoints will be cut to the corresponding</span>
<span class="sd">        front-end view, even if the total number of samples is lower than</span>
<span class="sd">        ``max_n_samples``, By default False.\n</span>
<span class="sd">        Remark that setting this parameter to True ensures that low frequency traces</span>
<span class="sd">        are added to the ``hf_data`` property.</span>
<span class="sd">    hf_x: Iterable, optional</span>
<span class="sd">        The original high frequency series positions, can be either a time-series or</span>
<span class="sd">        an increasing, numerical index. If set, this has priority over the trace its</span>
<span class="sd">        data.</span>
<span class="sd">    hf_y: Iterable, optional</span>
<span class="sd">        The original high frequency values. If set, this has priority over the</span>
<span class="sd">        trace its data.</span>
<span class="sd">    hf_text: Iterable, optional</span>
<span class="sd">        The original high frequency text. If set, this has priority over the trace</span>
<span class="sd">        its ``text`` argument.</span>
<span class="sd">    hf_hovertext: Iterable, optional</span>
<span class="sd">        The original high frequency hovertext. If set, this has priority over the</span>
<span class="sd">        trace its ```hovertext`` argument.</span>
<span class="sd">    hf_marker_size: Iterable, optional</span>
<span class="sd">        The original high frequency marker size. If set, this has priority over the</span>
<span class="sd">        trace its ``marker.size`` argument.</span>
<span class="sd">    hf_marker_color: Iterable, optional</span>
<span class="sd">        The original high frequency marker color. If set, this has priority over the</span>
<span class="sd">        trace its ``marker.color`` argument.</span>
<span class="sd">    check_nans: boolean, optional</span>
<span class="sd">        If set to True, the trace&#39;s data will be checked for NaNs - which will be</span>
<span class="sd">        removed. By default True.</span>
<span class="sd">        As this is a costly operation, it is recommended to set this parameter to</span>
<span class="sd">        False if you are sure that your data does not contain NaNs (or when the</span>
<span class="sd">        downsampler can handle NaNs, e.g., EveryNthPoint). This should considerably</span>
<span class="sd">        speed up the graph construction time.</span>
<span class="sd">    **trace_kwargs: dict</span>
<span class="sd">        Additional trace related keyword arguments.</span>
<span class="sd">        e.g.: row=.., col=..., secondary_y=...</span>

<span class="sd">        !!! info &quot;See Also&quot;</span>
<span class="sd">            [`Figure.add_trace`](https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html#plotly.graph_objects.Figure.add_trace&gt;) docs.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    BaseFigure</span>
<span class="sd">        The Figure on which ``add_trace`` was called on; i.e. self.</span>

<span class="sd">    !!! note</span>

<span class="sd">        Constructing traces with **very large data amounts** really takes some time.</span>
<span class="sd">        To speed this up; use this [`add_trace`][figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace] method and</span>

<span class="sd">        1. Create a trace with no data (empty lists)</span>
<span class="sd">        2. pass the high frequency data to this method using the ``hf_x`` and ``hf_y``</span>
<span class="sd">           parameters.</span>

<span class="sd">        See the example below:</span>
<span class="sd">            ```python</span>
<span class="sd">            &gt;&gt;&gt; from plotly.subplots import make_subplots</span>
<span class="sd">            &gt;&gt;&gt; s = pd.Series()  # a high-frequency series, with more than 1e7 samples</span>
<span class="sd">            &gt;&gt;&gt; fig = FigureResampler(go.Figure())</span>
<span class="sd">            &gt;&gt;&gt; fig.add_trace(go.Scattergl(x=[], y=[], ...), hf_x=s.index, hf_y=s)</span>
<span class="sd">            ```</span>

<span class="sd">        !!! todo</span>
<span class="sd">            * explain why adding x and y to a trace is so slow</span>
<span class="sd">            * check and simplify the example above</span>

<span class="sd">    !!! tip</span>

<span class="sd">        * If you **do not want to downsample** your data, set ``max_n_samples`` to the</span>
<span class="sd">          the number of datapoints of your trace!</span>

<span class="sd">    !!! warning</span>

<span class="sd">        * The ``NaN`` values in either ``hf_y`` or ``trace.y`` will be omitted! We do</span>
<span class="sd">          not allow ``NaN`` values in ``hf_x`` or ``trace.x``.</span>
<span class="sd">        * ``hf_x``, ``hf_y``, ``hf_text``, and ``hf_hovertext`` are useful when you deal</span>
<span class="sd">          with large amounts of data (as it can increase the speed of this add_trace()</span>
<span class="sd">          method with ~30%). These arguments have priority over the trace&#39;s data and</span>
<span class="sd">          (hover)text attributes.</span>
<span class="sd">        * Low-frequency time-series data, i.e. traces that are not resampled, can hinder</span>
<span class="sd">          the the automatic-zooming (y-scaling) as these will not be stored in the</span>
<span class="sd">          back-end and thus not be scaled to the view.</span>
<span class="sd">          To circumvent this, the ``limit_to_view`` argument can be set, resulting in</span>
<span class="sd">          also storing the low-frequency series in the back-end.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># to comply with the plotly data input acceptance behavior</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Trace must be either a dict or a BaseTraceType&quot;</span><span class="p">)</span>

    <span class="n">max_out_s</span> <span class="o">=</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_global_n_shown_samples</span> <span class="k">if</span> <span class="n">max_n_samples</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">max_n_samples</span>
    <span class="p">)</span>

    <span class="c1"># Validate the trace and convert to a trace object</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">BaseTraceType</span><span class="p">):</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_validator</span><span class="o">.</span><span class="n">validate_coerce</span><span class="p">(</span><span class="n">trace</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># First add a UUID, as each (even the non-hf_data traces), must contain this</span>
    <span class="c1"># key for comparison. If the trace already has a UUID, we will keep it.</span>
    <span class="n">uuid_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span> <span class="k">if</span> <span class="n">trace</span><span class="o">.</span><span class="n">uid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">trace</span><span class="o">.</span><span class="n">uid</span>
    <span class="n">trace</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="n">uuid_str</span>

    <span class="c1"># construct the hf_data_container</span>
    <span class="c1"># TODO in future version -&gt; maybe regex on kwargs which start with `hf_`</span>
    <span class="n">dc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_get_trace_props</span><span class="p">(</span>
        <span class="n">trace</span><span class="p">,</span>
        <span class="n">hf_x</span><span class="p">,</span>
        <span class="n">hf_y</span><span class="p">,</span>
        <span class="n">hf_text</span><span class="p">,</span>
        <span class="n">hf_hovertext</span><span class="p">,</span>
        <span class="n">hf_marker_size</span><span class="p">,</span>
        <span class="n">hf_marker_color</span><span class="p">,</span>
        <span class="n">check_nans</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># These traces will determine the autoscale its RANGE!</span>
    <span class="c1">#   -&gt; so also store when `limit_to_view` is set.</span>
    <span class="k">if</span> <span class="n">trace</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_high_frequency_traces</span><span class="p">:</span>
        <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_samples</span> <span class="o">&gt;</span> <span class="n">max_out_s</span> <span class="ow">or</span> <span class="n">limit_to_view</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">[i] DOWNSAMPLE </span><span class="si">{</span><span class="n">trace</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="se">\t</span><span class="si">{</span><span class="n">n_samples</span><span class="si">}</span><span class="s2">-&gt;</span><span class="si">{</span><span class="n">max_out_s</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_hf_data</span><span class="p">[</span><span class="n">uuid_str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_hf_data_dict</span><span class="p">(</span>
                <span class="n">dc</span><span class="p">,</span>
                <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span>
                <span class="n">downsampler</span><span class="o">=</span><span class="n">downsampler</span><span class="p">,</span>
                <span class="n">gap_handler</span><span class="o">=</span><span class="n">gap_handler</span><span class="p">,</span>
                <span class="n">max_n_samples</span><span class="o">=</span><span class="n">max_n_samples</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Before we update the trace, we create a new pointer to that trace in</span>
            <span class="c1"># which the downsampled data will be stored. This way, the original</span>
            <span class="c1"># data of the trace to this `add_trace` method will not be altered.</span>
            <span class="c1"># We copy (by reference) all the non-data properties of the trace in</span>
            <span class="c1"># the new trace.</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">_props</span>  <span class="c1"># convert the trace into a dict</span>
            <span class="c1"># NOTE: there is no need to store `marker` property here.</span>
            <span class="c1"># If needed, it will be added  to `trace` via `check_update_trace_data`</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">trace</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">_fields</span><span class="p">))</span>
            <span class="p">}</span>

            <span class="c1"># NOTE:</span>
            <span class="c1"># If all the raw data needs to be sent to the javascript, and the trace</span>
            <span class="c1"># is high-frequency, this would take significant time!</span>
            <span class="c1"># Hence, you first downsample the trace.</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_update_trace_data</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">trace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">AbstractFigureAggregator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_traces</span><span class="p">(</span>
                <span class="p">[</span><span class="n">trace</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_add_trace_to_add_traces_kwargs</span><span class="p">(</span><span class="n">trace_kwargs</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[i] NOT resampling </span><span class="si">{</span><span class="n">trace</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> - len=</span><span class="si">{</span><span class="n">n_samples</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">trace</span><span class="o">.</span><span class="n">_process_kwargs</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">dc</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dc</span><span class="o">.</span><span class="n">_fields</span><span class="p">})</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">AbstractFigureAggregator</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_traces</span><span class="p">(</span>
                <span class="p">[</span><span class="n">trace</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_add_trace_to_add_traces_kwargs</span><span class="p">(</span><span class="n">trace_kwargs</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_figure_class</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_traces</span><span class="p">(</span>
        <span class="p">[</span><span class="n">trace</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_add_trace_to_add_traces_kwargs</span><span class="p">(</span><span class="n">trace_kwargs</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_traces" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">add_traces</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">max_n_samples</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">downsamplers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gap_handlers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit_to_views</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">check_nans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">traces_kwargs</span><span class="p">)</span></code>

<a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_traces" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Add traces to the figure.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Make sure to look at the <a class="autorefs autorefs-internal" href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace"><code>add_trace</code></a> function for more info about
<strong>speed optimization</strong>, and dealing with not <code>high-frequency</code> data, but
still want to resample / limit the data to the front-end view.</p>
</div>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.List">List</span>[<span title="plotly.basedatatypes.BaseTraceType">BaseTraceType</span> | dict]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A list of trace specifications to be added.
Trace specifications may be either:</p>
<ul>
<li>Instances of trace classes from the plotly.graph_objs
    package (e.g plotly.graph_objs.Scatter, plotly.graph_objs.Bar).</li>
<li>
<p>Dicts where:</p>
<ul>
<li>The &lsquo;type&rsquo; property specifies the trace type (e.g.
    &lsquo;scatter&rsquo;, &lsquo;bar&rsquo;, &lsquo;area&rsquo;, etc.). If the dict has no &lsquo;type&rsquo;
    property then &lsquo;scatter&rsquo; is assumed.</li>
<li>All remaining properties are passed to the constructor
    of the specified trace type.</li>
</ul>
</li>
</ul>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>max_n_samples</code></td>
          <td>
                <code>None | <span title="typing.List">List</span>[int] | int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The maximum number of samples that will be shown for each trace.
  If a single integer is passed, all traces will use this number. If this
  variable is not set; <code>_global_n_shown_samples</code> will be used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>downsamplers</code></td>
          <td>
                <code>None | <span title="typing.List">List</span>[<span title="figure_resampler.aggregation.AbstractAggregator">AbstractAggregator</span>] | <span title="figure_resampler.aggregation.AbstractAggregator">AbstractAggregator</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The downsampler that will be used to aggregate the traces. If a single
aggregator is passed, all traces will use this aggregator.
If this variable is not set, <code>_global_downsampler</code> will be used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>gap_handlers</code></td>
          <td>
                <code>None | <span title="typing.List">List</span>[<span title="figure_resampler.aggregation.gap_handler_interface.AbstractGapHandler">AbstractGapHandler</span>] | <span title="figure_resampler.aggregation.gap_handler_interface.AbstractGapHandler">AbstractGapHandler</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The gap handler that will be used to aggregate the traces. If a single
gap handler is passed, all traces will use this gap handler.
If this variable is not set, <code>_global_gap_handler</code> will be used.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>limit_to_views</code></td>
          <td>
                <code>None | <span title="typing.List">List</span>[bool] | bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of limit_to_view booleans for the added traces. If set to True the
trace&rsquo;s datapoints will be cut to the corresponding front-end view, even if
the total number of samples is lower than <code>max_n_samples</code>.
If a single boolean is passed, all to be added traces will use this value,
by default False.</p>
<p>Remark that setting this parameter to True ensures that low frequency traces
are added to the <code>hf_data</code> property.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>check_nans</code></td>
          <td>
                <code>None | <span title="typing.List">List</span>[bool] | bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List of check_nans booleans for the added traces. If set to True, the
trace&rsquo;s datapoints will be checked for NaNs. If a single boolean is passed,
all to be added traces will use this value, by default True.</p>
<p>As this is a costly operation, it is recommended to set this parameter to
False if the data is known to contain no NaNs (or when the downsampler can
handle NaNs, e.g., EveryNthPoint). This will considerably speed up the graph
construction time.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>**traces_kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Additional trace related keyword arguments.
e.g.: rows=.., cols=&hellip;, secondary_ys=&hellip;</p>
<div class="admonition info">
<p class="admonition-title">See Also</p>
<p><a href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html#plotly.graph_objects.Figure.add_traces&gt;"><code>Figure.add_traces</code></a> docs.</p>
</div>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="plotly.basedatatypes.BaseFigure">BaseFigure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Figure on which <code>add_traces</code> was called on; i.e. self.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>plotly_resampler/figure_resampler/figure_resampler_interface.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_traces</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">BaseTraceType</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">|</span> <span class="n">BaseTraceType</span> <span class="o">|</span> <span class="n">Dict</span><span class="p">,</span>
    <span class="n">max_n_samples</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">downsamplers</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="n">AbstractAggregator</span><span class="p">]</span> <span class="o">|</span> <span class="n">AbstractAggregator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">gap_handlers</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">List</span><span class="p">[</span><span class="n">AbstractGapHandler</span><span class="p">]</span> <span class="o">|</span> <span class="n">AbstractGapHandler</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">limit_to_views</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">check_nans</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">traces_kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add traces to the figure.</span>

<span class="sd">    !!! note</span>

<span class="sd">        Make sure to look at the [`add_trace`][figure_resampler.figure_resampler_interface.AbstractFigureAggregator.add_trace] function for more info about</span>
<span class="sd">        **speed optimization**, and dealing with not ``high-frequency`` data, but</span>
<span class="sd">        still want to resample / limit the data to the front-end view.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : List[BaseTraceType  |  dict]</span>
<span class="sd">        A list of trace specifications to be added.</span>
<span class="sd">        Trace specifications may be either:</span>

<span class="sd">          - Instances of trace classes from the plotly.graph_objs</span>
<span class="sd">            package (e.g plotly.graph_objs.Scatter, plotly.graph_objs.Bar).</span>
<span class="sd">          - Dicts where:</span>

<span class="sd">              - The &#39;type&#39; property specifies the trace type (e.g.</span>
<span class="sd">                &#39;scatter&#39;, &#39;bar&#39;, &#39;area&#39;, etc.). If the dict has no &#39;type&#39;</span>
<span class="sd">                property then &#39;scatter&#39; is assumed.</span>
<span class="sd">              - All remaining properties are passed to the constructor</span>
<span class="sd">                of the specified trace type.</span>
<span class="sd">    max_n_samples : None | List[int] | int, optional</span>
<span class="sd">          The maximum number of samples that will be shown for each trace.</span>
<span class="sd">          If a single integer is passed, all traces will use this number. If this</span>
<span class="sd">          variable is not set; ``_global_n_shown_samples`` will be used.</span>
<span class="sd">    downsamplers : None | List[AbstractAggregator] | AbstractAggregator, optional</span>
<span class="sd">        The downsampler that will be used to aggregate the traces. If a single</span>
<span class="sd">        aggregator is passed, all traces will use this aggregator.</span>
<span class="sd">        If this variable is not set, ``_global_downsampler`` will be used.</span>
<span class="sd">    gap_handlers : None | List[AbstractGapHandler] | AbstractGapHandler, optional</span>
<span class="sd">        The gap handler that will be used to aggregate the traces. If a single</span>
<span class="sd">        gap handler is passed, all traces will use this gap handler.</span>
<span class="sd">        If this variable is not set, ``_global_gap_handler`` will be used.</span>
<span class="sd">    limit_to_views : None | List[bool] | bool, optional</span>
<span class="sd">        List of limit_to_view booleans for the added traces. If set to True the</span>
<span class="sd">        trace&#39;s datapoints will be cut to the corresponding front-end view, even if</span>
<span class="sd">        the total number of samples is lower than ``max_n_samples``.</span>
<span class="sd">        If a single boolean is passed, all to be added traces will use this value,</span>
<span class="sd">        by default False.\n</span>
<span class="sd">        Remark that setting this parameter to True ensures that low frequency traces</span>
<span class="sd">        are added to the ``hf_data`` property.</span>
<span class="sd">    check_nans : None | List[bool] | bool, optional</span>
<span class="sd">        List of check_nans booleans for the added traces. If set to True, the</span>
<span class="sd">        trace&#39;s datapoints will be checked for NaNs. If a single boolean is passed,</span>
<span class="sd">        all to be added traces will use this value, by default True.\n</span>
<span class="sd">        As this is a costly operation, it is recommended to set this parameter to</span>
<span class="sd">        False if the data is known to contain no NaNs (or when the downsampler can</span>
<span class="sd">        handle NaNs, e.g., EveryNthPoint). This will considerably speed up the graph</span>
<span class="sd">        construction time.</span>
<span class="sd">    **traces_kwargs: dict</span>
<span class="sd">        Additional trace related keyword arguments.</span>
<span class="sd">        e.g.: rows=.., cols=..., secondary_ys=...</span>

<span class="sd">        !!! info &quot;See Also&quot;</span>

<span class="sd">            [`Figure.add_traces`](https://plotly.com/python-api-reference/generated/plotly.graph_objects.Figure.html#plotly.graph_objects.Figure.add_traces&gt;) docs.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    BaseFigure</span>
<span class="sd">        The Figure on which ``add_traces`` was called on; i.e. self.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># note: Plotly its add_traces also a allows non list-like input e.g. a scatter</span>
    <span class="c1"># object; the code below is an exact copy of their internally applied parsing</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">]</span>

    <span class="c1"># Convert each trace into a BaseTraceType object</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_validator</span><span class="o">.</span><span class="n">validate_coerce</span><span class="p">(</span><span class="n">trace</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">BaseTraceType</span><span class="p">)</span>
        <span class="k">else</span> <span class="n">trace</span>
        <span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">data</span>
    <span class="p">]</span>

    <span class="c1"># First add a UUID, as each (even the non-hf_data traces), must contain this</span>
    <span class="c1"># key for comparison. If the trace already has a UUID, we will keep it.</span>
    <span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">uuid_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid4</span><span class="p">())</span> <span class="k">if</span> <span class="n">trace</span><span class="o">.</span><span class="n">uid</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">trace</span><span class="o">.</span><span class="n">uid</span>
        <span class="n">trace</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="n">uuid_str</span>

    <span class="c1"># Convert the data properties</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">max_n_samples</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="ow">or</span> <span class="n">max_n_samples</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">max_n_samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">max_n_samples</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">downsamplers</span><span class="p">,</span> <span class="n">AbstractAggregator</span><span class="p">)</span> <span class="ow">or</span> <span class="n">downsamplers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">downsamplers</span> <span class="o">=</span> <span class="p">[</span><span class="n">downsamplers</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">gap_handlers</span><span class="p">,</span> <span class="n">AbstractGapHandler</span><span class="p">)</span> <span class="ow">or</span> <span class="n">gap_handlers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gap_handlers</span> <span class="o">=</span> <span class="p">[</span><span class="n">gap_handlers</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">limit_to_views</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">limit_to_views</span> <span class="o">=</span> <span class="p">[</span><span class="n">limit_to_views</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">check_nans</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">check_nans</span> <span class="o">=</span> <span class="p">[</span><span class="n">check_nans</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">zipped</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">max_n_samples</span><span class="p">,</span> <span class="n">downsamplers</span><span class="p">,</span> <span class="n">gap_handlers</span><span class="p">,</span> <span class="n">limit_to_views</span><span class="p">,</span> <span class="n">check_nans</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span>
        <span class="n">i</span><span class="p">,</span>
        <span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">max_out</span><span class="p">,</span> <span class="n">downsampler</span><span class="p">,</span> <span class="n">gap_handler</span><span class="p">,</span> <span class="n">limit_to_view</span><span class="p">,</span> <span class="n">check_nan</span><span class="p">),</span>
    <span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">zipped</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">trace</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_high_frequency_traces</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hf_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="k">continue</span>

        <span class="n">max_out_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_n_shown_samples</span> <span class="k">if</span> <span class="n">max_out</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">max_out</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">limit_to_view</span> <span class="ow">and</span> <span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">max_out_s</span><span class="p">):</span>
            <span class="k">continue</span>

        <span class="n">dc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_get_trace_props</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">check_nans</span><span class="o">=</span><span class="n">check_nan</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hf_data</span><span class="p">[</span><span class="n">trace</span><span class="o">.</span><span class="n">uid</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_hf_data_dict</span><span class="p">(</span>
            <span class="n">dc</span><span class="p">,</span>
            <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span>
            <span class="n">downsampler</span><span class="o">=</span><span class="n">downsampler</span><span class="p">,</span>
            <span class="n">gap_handler</span><span class="o">=</span><span class="n">gap_handler</span><span class="p">,</span>
            <span class="n">max_n_samples</span><span class="o">=</span><span class="n">max_out</span><span class="p">,</span>
            <span class="n">offset</span><span class="o">=</span><span class="n">i</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># convert the trace into a dict, and only withholds the non-hf props</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">_props</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">trace</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">_fields</span><span class="p">))}</span>

        <span class="c1"># update the trace data with the HF props</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_update_trace_data</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">trace</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">trace</span>

    <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_figure_class</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_traces</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">traces_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="figure_resampler.figure_resampler_interface.AbstractFigureAggregator.construct_update_data_patch" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">construct_update_data_patch</span><span class="p">(</span><span class="n">relayout_data</span><span class="p">)</span></code>

<a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.construct_update_data_patch" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Construct the Patch of the to-be-updated front-end data, based on the layout
change.</p>
<h5 id="figure_resampler.figure_resampler_interface.AbstractFigureAggregator.construct_update_data_patch--attention">Attention<a class="headerlink" href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.construct_update_data_patch--attention" title="Permanent link">&para;</a></h5>
<p>This method is tightly coupled with Dash app callbacks. It takes the front-end
figure its <code>relayoutData</code> as input and returns the <code>dash.Patch</code> which needs
to be sent to the <code>figure</code> property for the corresponding <code>dcc.Graph</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>relayout_data</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A dict containing the <code>relayoutData</code> (i.e., the changed layout data) of
the corresponding front-end graph.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>dash.Patch:</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The Patch object containing the figure updates which needs to be sent to
the front-end.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>plotly_resampler/figure_resampler/figure_resampler_interface.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">construct_update_data_patch</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">relayout_data</span><span class="p">:</span> <span class="nb">dict</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">dash</span><span class="o">.</span><span class="n">Patch</span><span class="p">,</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the Patch of the to-be-updated front-end data, based on the layout</span>
<span class="sd">    change.</span>

<span class="sd">    Attention</span>
<span class="sd">    ---------</span>
<span class="sd">    This method is tightly coupled with Dash app callbacks. It takes the front-end</span>
<span class="sd">    figure its ``relayoutData`` as input and returns the ``dash.Patch`` which needs</span>
<span class="sd">    to be sent to the ``figure`` property for the corresponding ``dcc.Graph``.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    relayout_data: dict</span>
<span class="sd">        A dict containing the ``relayoutData`` (i.e., the changed layout data) of</span>
<span class="sd">        the corresponding front-end graph.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dash.Patch:</span>
<span class="sd">        The Patch object containing the figure updates which needs to be sent to</span>
<span class="sd">        the front-end.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">update_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_construct_update_data</span><span class="p">(</span><span class="n">relayout_data</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">update_data</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">update_data</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dash</span><span class="o">.</span><span class="n">no_update</span>

    <span class="n">patched_figure</span> <span class="o">=</span> <span class="n">dash</span><span class="o">.</span><span class="n">Patch</span><span class="p">()</span>  <span class="c1"># create patch</span>
    <span class="k">for</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">update_data</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>  <span class="c1"># skip first item as it contains the relayout</span>
        <span class="n">trace_index</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;index&quot;</span><span class="p">)</span>  <span class="c1"># the index of the corresponding trace</span>
        <span class="c1"># All the other items are the trace properties which needs to be updated</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">trace</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># NOTE: we need to use the `patched_figure` as a dict, and not</span>
            <span class="c1"># `patched_figure.data` as the latter will replace **all** the</span>
            <span class="c1"># data for the corresponding trace, and we just want to update the</span>
            <span class="c1"># specific trace its properties.</span>
            <span class="n">patched_figure</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">][</span><span class="n">trace_index</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="k">return</span> <span class="n">patched_figure</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="figure_resampler.figure_resampler_interface.AbstractFigureAggregator.replace" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">replace</span><span class="p">(</span><span class="n">figure</span><span class="p">,</span> <span class="n">convert_existing_traces</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#figure_resampler.figure_resampler_interface.AbstractFigureAggregator.replace" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Replace the current figure layout with the passed figure object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>figure</code></td>
          <td>
                <code><span title="plotly.Figure">Figure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The figure object which will replace the existing figure.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>convert_existing_traces</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A bool indicating whether the traces of the passed <code>figure</code> should be
resampled, by default True.</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>plotly_resampler/figure_resampler/figure_resampler_interface.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figure</span><span class="p">:</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">convert_existing_traces</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Replace the current figure layout with the passed figure object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    figure: go.Figure</span>
<span class="sd">        The figure object which will replace the existing figure.</span>
<span class="sd">    convert_existing_traces: bool, Optional</span>
<span class="sd">        A bool indicating whether the traces of the passed ``figure`` should be</span>
<span class="sd">        resampled, by default True.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_clear_figure</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">figure</span><span class="o">=</span><span class="n">figure</span><span class="p">,</span>
        <span class="n">convert_existing_traces</span><span class="o">=</span><span class="n">convert_existing_traces</span><span class="p">,</span>
        <span class="n">default_n_shown_samples</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_global_n_shown_samples</span><span class="p">,</span>
        <span class="n">default_downsampler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_global_downsampler</span><span class="p">,</span>
        <span class="n">default_gap_handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_global_gap_handler</span><span class="p">,</span>
        <span class="n">resampled_trace_prefix_suffix</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_suffix</span><span class="p">),</span>
        <span class="n">show_mean_aggregation_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_show_mean_aggregation_size</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_print_verbose</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.path", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>